第十一章
欧几里得空间
最美丽的人。
-赫尔曼·明可夫斯基
11.1内部产品、欧几里得空间
到目前为止，向量空间的框架允许我们处理向量的比例和线性组合，但是没有办法表达角度的概念或讨论向量的正交性。欧几里得结构允许我们处理度量概念，如角度、正交性和长度（或距离）。
本章介绍欧几里得几何的基本内容。第12章研究了欧几里得几何的深层次。我们的主要目标之一是给出保持欧几里得结构、旋转和反射的变换的基本性质，因为它们在实践中起着重要作用。欧几里得几何学是研究某些仿射映射（称为刚性运动）下不变性质的学科。刚性运动是保持点之间距离的贴图。
我们首先定义内部积和欧几里得空间。给出了柯西-施瓦兹不等式和明可夫斯基不等式。我们定义了向量和子空间、正交基和正交基的正交性。我们证明了每个有限维欧氏空间都有正交基。第一个证明使用对偶性，第二个证明使用格拉姆-施密特正交化过程。可逆矩阵的QR分解是格拉姆-施密特程序的一个应用。简单地定义和研究了线性等轴测（也称为正交变换）。最后，我们用一个简短的部分来总结欧几里得几何的一些应用。最重要的应用之一，最小二乘法，将在第21章中讨论。
关于欧几里得几何学的更详细的论述，请参阅Berger[5，6]、Snapper and Troyer[59]或任何其他几何学书籍，如Pedoe[51]、Coxeter[15]、Fresnel[22]、Tisseron[67]或Cagnac、Ramis和Commeu[12]。严肃的读者应该咨询埃米尔。
阿廷的名著[2]也包含了对正交群的深入研究。
三百七十七
像其他几何中出现的群一样。仍然值得参考一些古老的经典著作，如Hadamard[31，32]和Rouch'e和De Combourse[52]。[31]的第一版于1898年出版，最终于1947年出版第十三版！在本章中，假设所有向量空间都定义在实数的字段r上，除非另有规定（在少数情况下，定义在复数c上）。
首先，我们在向量空间上定义一个欧几里得结构。从技术上讲，矢量空间E上的欧几里得结构是由满足某些额外性质的矢量空间上的对称双线性形式提供的。回想一下双线性形式，如果对于每个u∈e，u=06，则定义为：e×e→r；如果对于每个u∈e，则定义为：θ（u，u）=06；如果对于每个u∈e，则定义为正。
定义11.1.欧几里得空间是一个实向量空间e，它具有对称双线性形式，即：e×e→r，是正定的。更明确地说，_：e×e→r满足
网络错误		
网络错误	网络错误	网络错误
网络错误	网络错误	网络错误
网络错误	网络错误	网络错误
网络错误	网络错误	网络错误
网络错误	网络错误	网络错误
网络错误	网络错误	网络错误
实数（u，v）也被称为u和v的内积（或标量积）。我们还定义了与之相关联的二次型为函数Φ：e→r+，这样
Φ（u）＝（u，u）、
对于所有的u∈e。
既然π是双线性的，我们就有了π（0,0）=0，既然它是正定的，我们就有了更强有力的事实：
⑨（u，u）=0 iff u=0，
也就是说，当u=0时，Φ（u）=0。
给定向量空间e上的内积，我们也用
u·v或hu、vi或（u v）
以及Kuk的pΦ（u）。例11.1。欧几里得空间的标准例子是Rn，在内积下定义如下：
（x1，…，xn）·（y1，…，yn）=x1y1+x2y2+····+xnyn.
这个欧几里得空间用en表示。
还有其他的例子。
例11.2。例如，让e是维度2的向量空间，让（e1，e2）是e的基础。如果a>0和b2−ac<0，双线性形式定义如下：
⑨（x1e1+y2e2，x2e1+y2e2）=axix2+b（x1y2+x2y1）+cy1y2
在E上生成一个欧几里德结构。在这种情况下，
Φ（Xe1+Ye2）=ax2+2bxy+cy2。
例11.3。让c[a，b]表示一组连续函数f[a，b]→r。很容易检查c[a，b]是一个无限维的向量空间。给定任意两个函数f，g∈c[a，b]，让

我们把它作为一个简单的练习，即H−，−I实际上是C[A，B]上的一个内积。在A=−π和B=π（或A=0和B=2π，这基本上没有区别）的情况下，应该计算
HSINPX、SINQXI、HSINPX、COSQXI和HCOSPX、COSQXI，
对于所有自然数p，q≥1。这些计算的结果使傅立叶分析成为可能！
例11.4。设e=mn（r）为实n×n矩阵的向量空间。如果我们把一个矩阵a∈mn（r）看作是一个“长”列向量，把它的列连在一起，我们就可以把两个矩阵a，b∈mn（r）的内积定义为
，
可以方便地写为
ha，bi=tr（a>b）=tr（b>a）。
因为这可以看作是RN2上的欧几里得积，所以它是mn（r）上的内积。相应的规范
kakf=ptr（a>a）
是弗罗贝尼乌斯规范（见第8.2节）。
让我们观察一下，可从Φ中恢复。
提案11.1.我们有

对于所有的u，v∈e，我们说，a是Φ的极性形式。
证据。根据双线性和对称性，我们有
Φ（u+v）=（u+v，u+v）
=_（u，u+v）+_（v，u+v）
=_（u，u）+2（u，v）+_（v，v）=Φ（u）+2（u，v）+Φ（v）。
如果e是有限维，如果_：e×e→r是e上的双线性形式，给定任何基础
（e1，…
.
如果我们让g为矩阵g=（（ei，ej）），如果x和y是与（x1，…，xn）和（y1，…，yn）相关联的列向量，那么我们可以写
⑨（x，y）=x>gy=y>g>x。
注意，我们犯了一个符号滥用的错误，因为它是e中的向量，但是与（x1，…，xn）相关联的列向量属于rn。为了避免这种轻微的滥用，我们可以用x表示与（x1，…，xn）相关联的列向量（对于与（y1，…，yn）相关联的列向量，也可以用y表示），在wich情况下，“正确”的表示是
⑨（x，y）=x>gy。
然而，考虑到e和rn之间的同构，为了尽可能简单地保持符号，我们将使用x和y而不是x和y。
另外，观察到_为对称iff g=g>，且_为正定iff，矩阵g为正定，即，
x>gx>0表示所有x∈rn，x=06。
与内积相关的矩阵G称为内积相对于基（e1，…，en）的G矩阵。
相反，如果a是对称正定n×n矩阵，则很容易检查双线性形式
hx，yi=x>ay
是内部产品。如果我们把基从基（e1，…，en）改为基（f1，…，fn），如果基矩阵的变化是p（其中p的jth列由基（e1，…，en）上的fj坐标组成），那么对于基（f1，…，fn）上的x0和y0坐标，我们有
x>gy=x0>p>gpy0，
因此，我们内部产品的基矩阵（f1，…，fn）是p>gp。我们将这些事实概括为以下命题。
提案11.2.设e为有限维向量空间，设（e1，…，en）为e的基础。
1.	对于任何内积H−、−i on e，如果g=（hei，eji）是内积H−、−i w.r.t的克矩阵。基（e1，…，en），则g是对称正定的。
2.	对于基矩阵p的任何变化，相对于新基，h−、−i的g矩阵是p>gp。
3.	如果a是任意n×n对称正定矩阵，则
hx，yi=x>ay
是E上的内部产品。
稍后我们将看到一个对称矩阵是正定的，如果它的特征值都是正的。

内积的一个非常重要的性质是，图U 7→PΦ（U）是一个范数。
提案11.3.设e为内积_的欧几里得空间，设Φ为相应的二次型。对于所有的u，v∈e，我们有柯西-施瓦兹不等式。
⑨（u，v）2≤Φ（u）Φ（v）、
当f u和v相等时，它们是线性相关的。
我们还有明可夫斯基不平等
磷磷
Φ（U+V）≤Φ（U）+Φ（V）、
等式保持iff u和v是线性相关的，此外，如果u=06和v=06，则对于某些λ>0，u=λv。
证据。对于任何向量u，v∈e，我们定义函数t:r→r，这样
t（λ）=Φ（u+λv）
对于所有的λ∈r，利用双线性和对称性，我们得到
网络错误	网络错误	网络错误
	网络错误	网络错误
	网络错误	网络错误
	网络错误	网络错误
既然ω是正定的，那么Φ是非负的，因此t（λ）≥0代表所有的λ∈r。如果Φ（v）=0，那么v=0，我们也有（u，v）=0。在这种情况下，柯西-施瓦兹不等式是微不足道的，v=0和u是线性相关的。
现在假设Φ（v）>0。由于t（λ）≥0，二次方程
λ2Φ（v）+2λ（u，v）+Φ（u）=0
不能有明显的实根，这意味着它的判别式
∆=4（_（u，v）2−Φ（u）Φ（v））
是零还是负，这正是柯西-施瓦兹不等式。
⑨（u，v）2≤Φ（u）Φ（v）。
现在让我们考虑一下我们有平等的情况
⑨（u，v）2=Φ（u）Φ（v）。
有两种情况。如果Φ（v）=0，则v=0，u和v是线性相关的。如果Φ（v）=06，则上述二次方程有一个双根λ0，我们得到Φ（u+λ0v）=0。由于_为正定，因此Φ（u+λ0v）=0表示u+λ0v=0，这表明u和v是线性相关的。相反，当u和v是线性相关时，很容易检查我们是否具有相等性。明可夫斯基不平等
磷磷
Φ（U+V）≤Φ（U）+Φ（V）
等于
Φ（U+V）≤Φ（U）+Φ（V）+2PΦ（U）Φ（V）。
但是，我们已经证明
2Ф（u，v）=Φ（u+v）−Φ（u）−Φ（v）、
所以上面的不等式等于

⑨（u，v）≤pΦ（u）Φ（v）、
式中，当ω（u，v）≤0时，这是微不足道的，当ω（u，v）≥0时，从柯西-施瓦兹不等式得出。因此，明可夫斯基不平等是成立的。最后假设u=06，v=06，那么
磷磷
Φ（U+V）=Φ（U）+Φ（V）。
在这种情况下，我们
⑨（u，v）=pΦ（u）Φ（v）、
通过对柯西-施瓦兹不等式的讨论，我们知道，当u和v是线性相关的时，等式成立。当u或v为空时，minkowski不等式是一个等式。否则，如果u=06，v=06，那么对于某些λ=06，u=λv，并且由于
⑨（u，v）＝λ⑨（v，v）=pΦ（u）Φ（v）、
根据正性，我们必须有λ>0。
注意，柯西-施瓦兹不等式也可以写成
|⑨（U，V）≤PΦ（U）PΦ（V）。
注：很容易证明柯西-施瓦兹不等式和Minkowski不等式仍然适用于一个正的对称双线性形式，但不一定是确定的（即，所有u，v∈e，u，v）≥0）。然而，当等式成立时，u和v不需要线性依赖。
明可夫斯基不平等
磷磷
Φ（U+V）≤Φ（U）+Φ（V）
结果表明，映射u 7→pΦ（u）满足定义8.1的凸不等式（又称三角不等式）、条件（n3），且由于π为双线性正定，因此它也满足定义8.1的条件（n1）和（n2），因此它是e上的范数，由π引起的范数。被称为_诱导的欧几里得范数。柯西-施瓦兹不等式可以写成
| U·V≤Kukkkvk，
以及Minkowski不等式
ku+vk≤kuk+kvk。
如果u和v是非零向量，那么柯西-施瓦兹不等式意味着
.
然后有一个独特的θ∈[0，π]，这样
.
我们有u=v iffθ=0和u=−v iffθ=π。对于0<θ<π，矢量su和uv，使得v是线性独立的，平面的方向由
θ是u和v之间的角度。关于方向的精确概念，请参见问题11.8。如果u是单位向量（也就是说kuk=1），那么向量
（kvkcosθ）u=（u·v）u=（v·u）u
称为V向U所跨越的空间的正交投影。
注：人们可能会想，向量空间上的每一个范数是否都是由某个欧几里得内积引起的。一般来说，这是错误的，但值得注意的是，有一个简单的必要和充分条件，即范数必须满足平行四边形定律：
ku+vk2+ku−vk2=2（kuk2+kvk2）。
见图11.1。

图11.1：平行四边形定律表明，由向量u和v确定的平行四边形对角线长度之和等于所有边的和。如果H−，−I是内积，那么我们有
ku+vk22=kuk22+kvk22+2hu，vi
ku−vk=kuk+kvk−2hu，vi，
通过加减这些恒等式，我们得到了平行四边形定律和方程
，
这使我们能够从标准中恢复H−I。
相反，如果k k是一个满足平行四边形定律的范数，并且它来自一个内积，那么这个内积必须由
.
我们需要证明上述形式确实是对称的双线性的。
对称性保持是因为k u−v k=k−（u−v）k=kv−uk。让我们用平行四边形定律证明变量u的可加性。
2（KX+ZK2+KYK2）=KX+Y+ZK2+KX−Y+ZK2
会产生
KX+Y+ZK22=2（KX+ZK22+KYK22）−KX−Y+ZK22
KX+Y+ZK=2（KY+ZK+KXK）−KY−X+ZK，
其中第二个公式是通过交换x和y得到的，然后将这些公式相加，我们得到
.
用上式中的-z替换z，我们得到
，
自Kxx+z）k=
KX-Y-

根据需要。证明hλx，yi=λhx，yi代表所有λ∈r
有点棘手。其策略是先证明λ∈z的恒等式，然后将其推广到q，再通过连续性将其推广到r。
自从

该财产持有λ=−1。通过线性和归纳，对于任意n∈n，n≥1，写n=n−1+1，我们得到
hλx，yi=λhx，yi代表所有λ∈n，
由于上面也适用于λ=−1，所以它适用于所有的λ∈z。对于λ=p/q，p，q∈z和q 6=0，我们有qh（p/q）u，vi=hpu，vi=phu，vi，
表示h（p/q）u，vi=（p/q）hu，vi，
因此，hλx，yi=λhx，yi代表所有的λ∈q。
为了完成证明，我们使用了一个事实，即一个范数是一个连续的映射X→K7XK。那么，连续函数t 7→0 1t。在λ=0上定义的casehtu，vi是微不足道的，所以我们就这样做了。r−0同意hu，vi关于q−0，所以它等于hu，vi关于r−{
我们现在定义正交性。
11.2欧几里得空间的正交性和对偶性
向量空间上的内积可以定义正交性的概念。非零对正交向量族必须是线性无关的。它们被称为正交族。在有限维的向量空间中，总是可以找到正交基。这在理论上和实践上都非常有用。实际上，在正交的基础上，找到向量的坐标是非常便宜的：它需要一个内积。傅立叶级数充分利用了这个事实。当e有有限维时，我们证明了e上的内积在e与其对偶空间e之间产生了自然同构。这允许我们以一种内在的方式（即独立于基）定义线性映射的伴随。也可以对任何基础进行正交规范化（当然，当维度是有限的时）。我们给出了两个证明，一个使用对偶，另一个使用格拉姆-施密特正交化程序更具建设性。
定义11.2.给定欧几里德空间e，任意两个向量i i u，v∈e是正交的，orui）i∈i是垂直的，如果u·v=0。给定e中向量的一个族（u）∈我们称之为（正交，如果u i·u j=0，则所有i，j∈i，其中i 6=j。我们称该族（ui）i∈i为

对于所有i，j∈i，其中i=6 j，kuik=ui·ui=1，对于所有i∈i，如果ui·uj=0，则为正交。
对于e的任何子集f，集合
f=v∈e u·v=0，对于所有u∈f，
在所有与f中所有向量正交的向量中，称为f的正交补。
由于内积是正定的，所以观察到对于任何向量u∈e，我们有
u·v=0表示所有v∈e iff u=0。
立即证实f的正交补码f是e的子空间。例11.5。回到示例11.3和内部产品

在向量空间c[−π，π]上，很容易检查
1，
PX，QX
0，如果p=6 q，p，q≥1，
1，
COSPX、COSQX=
如果p=6 q，p，q≥0，
和
Xinpx，cosqxi=0，
对于所有p≥1和q≥0，当然，
因此，家族（sinpx）p≥1（cos−qx）q≥0是正交的。不正态，√√

但如果我们把每个三角函数除以π，1除以2π，就会变成这样。
提案11.4.给定欧几里德空间e，对于e中非零向量的任何族（ui）i∈i，如果（ui）i∈i是正交的，那么它是线性无关的。证据。假设存在线性相关性

对于i的某个λj∈r和某个有限子集j，通过对任意i∈j取带ui的内积，利用内积的双线性度和当i=6j时ui·uj=0的事实，我们得到
！
0=ui·0=ui·xλjuj
J J
=xλj（ui·uj）=λi（ui·ui），
J J
所以
λi（ui·ui）=0，对于所有i∈j，
由于ui=06，且内积为正定，ui·ui=06，因此我们得到
λi=0，对于所有i∈j，
说明了族（ui）i∈i是线性独立的。
我们将下面的简单结果留作练习。
提案11.5。给定欧几里得空间e，任意两个向量u，v∈e是正交iff
ku+vk2=kuk2+kvk2。
几何解释见图11.2。

图11.2：直角三角形两边的长度之和等于斜边的长度，即勾股定理。
正交基的一个最有用的特征是，它们提供了一种计算任意基向量上向量坐标的非常简单的方法。实际上，假设（e1，…，em）是一个正态基。对于任何向量
x=x1e1+·····+xmem，
如果我们计算内积x·ei，我们得到
x	·EI＝X1E1·EI+··+ XIEI·EI+···XMEM·EI＝XI，
自从
，

图11.3：红色矢量x在黑色基矢量ei上的正交投影是褐红色矢量xiei。观察x·ei=kxkcosθ。
正态族的特征。因此，
xi	=x·ei，
也就是说，xiei=（x·ei）ei是x对基向量ei生成的子空间的正交投影。见图11.3。如果基是正交的，但不一定是正交的，那么
.
即使对于无穷大正交（或正交）基（ei）i∈i，所有这些都是正确的。
但是，记住每个向量x都表示为线性组合

其中标量族（Xi）i i具有有限的支持，这意味着对于所有i i j j，Xi＝0，其中j是有限集。因此，即使族（sinpx）p≥1（cosqx）q≥0是正交的（它不是正交的，但如果我们将每个三角函数除以√π，1除以√2π，就会变成正交的，我们不会因为它看起来杂乱！），函数f∈c0[−π，π]可以写成傅立叶级数

并不意味着（sinpx）p≥1（cosqx）q≥0是函数向量空间的基础，因为一般来说，族（ak）和（bk）没有有限的支持！为了使这种无限线性组合有意义，有必要证明部分和

当n变为无穷大时，级数的收敛到极限。这需要空间上的拓扑结构。
有限维欧几里德空间的一个非常重要的性质是内积在向量空间E与其对偶E之间产生一个规范的双射（即不依赖于基的选择）。原因是内部产品·：e×e→r定义了一个非退化配对，定义见10.4。实际上，如果u·v=0表示所有v∈e，则u=0；同样，如果u·v=0表示所有u∈e，则v=0（因为内积是正定对称的）。根据命题10.6，E和E之间存在一个规范同构。我们认为，如果我们显式地展示这个映射，并谴责它是同构的话，读者会感激的。
从E到E的映射定义如下。
定义11.3.对于任何向量u∈e，设u:e→r为定义为
u（v）=u·v，对于所有v∈e。
由于内积是双线性的，所以图_u是e_中的线性形式。因此，我们有一个地图[：e→e，定义如下：
[（u）=u.
定理11.6。给定欧几里得空间e，地图[：e→e定义如下：
[（u）=u
是线性的和内射的。当e也是有限维时，映射[：e→e是一个正则同构。
证据。[：e→e是一个线性映射，它直接从内积是双线性这一事实出发。如果u=v，则所有w∈e的u（w）=v（w），根据u的定义，这意味着所有w∈e的u·w=v·w，通过双线性度，这相当于
（V−U）·W=0
对于所有的w∈e，这意味着u=v，因为内积是正定的。因此，[：e→e是内射的。最后，当e是有限维n时，我们知道e也是维n，那么[：e→e是双射的。
同构的逆[：e→e用]：e→e表示。由于定理11.6，我们有以下推论。
推论11.7。如果e是有限维的欧几里德空间，则每一个线性形式f∈e都对应一个唯一的u∈e，这样
f（v）=u·v，每v∈e。
特别地，如果f不是零形式，那么f的核心，即超平面h，就是一组与u正交的向量。
评论：
(1)	“音乐地图”[：e→e在e具有无限维度时不是主观的。通过将我们的注意力限制在连续线性映射上，并假设向量空间e是希尔伯特空间（即，e是一个完全赋范向量空间w.r.t.欧几里得范数），可以挽救结果。这就是著名的“小”里兹定理（或里兹表示定理）。
(2)	定理11.6仍然成立，如果E上的内积被非退化对称双线性形式_替换。我们说对称双线性形式，如果每一个u∈e，那么它是非退化的。
如果所有v∈e中的（u，v）=0，则u=0。
例如，R4上的对称双线性形式（洛伦兹形式）定义如下：
⑨（（x1，x2，x3，x4），（y1，y2，y3，y4））=x1y1+x2y2+x3y3−x4y4
是不退化的。然而，也存在非零向量u∈r4，使得（u，u）=0，这在欧几里得空间中是不可能的。这种矢量称为各向同性。
例11.6。考虑RN和它通常的欧几里得内积。给定任意可微函数f:u→r，其中u是Rn的开子集，根据定义，对于任意x∈un，f在x处的总导数dfx是线性形式，因此对于所有u=（u1，…，un）∈r，
.
唯一向量v∈rn，这样
v·u=dfx（u）表示所有u∈rn
是f的雅可比矩阵在x处的转置，1×n矩阵
.
这是f在x处的梯度梯度（f）x，由
梯度（.
例11.7。给定任意两个向量u，v∈r3，设c（u，v）为
c（u，v）（w）=det（u，v，w），对于所有w∈r3。
自从
，
我们看到唯一向量z∈r3，这样
z·w=c（u，v）（w）=det（u，v，w），对于所有w∈r3
是向量
.
这只是u和v的叉积u×v。由于det（u，v，u）=det（u，v，v）=0，我们发现nu×v与u和v都是正交的。上面允许我们将叉积推广到r。给定任意nn-1向量u1，…，un-1∈r，交叉积u1×······×un-1是r中的唯一向量，这样
（u1×·····×un-1）·w=所有w∈rn的det（u1，…，un-1，w）。
例11.8。考虑内积为ha，bi=tr（a>b）的实n×n矩阵的向量空间mn（r）。设为：mn（r）→r为
，
其中a=（aij）。立即证明S是线性形式。很容易检查唯一矩阵z
hz，ai=s（a），对于所有a∈mn（r）
是矩阵z=一（n，n），其条目均等于1。

11.3。线性映射的伴随
11.3线性图的伴随
同构的存在对伴随图的存在至关重要。伴随映射的重要性源于物理问题中产生的线性映射往往是自伴随的，这意味着f=f。此外，自伴映射可以在特征向量的正交基上对角化。这是解决力学和工程中许多问题的关键（见Strang[63]）。
设e为有限维n的欧几里得空间，设f:e→e为线性映射。对于每一个u∈e，图v 7→u·f（v）
显然是e中的线性形式，根据定理11.6，e中有一个用f（u）表示的唯一向量，使得f（u）·v=u·f（v），
对于每一个v e，下面的简单命题表明映射f是线性的。
提案11.8.给定一个有限维的欧几里得空间e，对于每一个线性映射f:e→e，都有一个唯一的线性映射f：e→e，这样
f（u）·v=u·f（v），对于所有u，v∈e。
证据。给定u1，u2∈e，由于内积是双线性的，我们得到
（u1+u2）·f（v）=u1·f（v）+u2·f（v），
对于所有v∈e，和
（f（u1）+f（u2））·v=f（u1）·v+f（u2）·v，
对于所有的v∈e，由于假设，
f（u1）·v=u1·f（v）和f（u2）·v=u2·f（v），
对于所有的v∈e，因此我们得到
（f（u1）+f（u2））·v=（u1+u2）·f（v）=f（u1+u2）·v，
对于所有的v∈e，因为[是双目标的，这意味着
f（u1+u2）=f（u1）+f（u2）。
同样地，
（λu）·f（v）=λ（u·f（v）），
对于所有v∈e，和
（λf（u））·v=λ（f（u）·v），
对于所有的v∈e，由于假设，
F（U）·V=U·F（V）
对于所有的v∈e，我们得到
（λf（u））·v=λ（u·f（v））=（λu）·f（v）=f（λu）·v
对于所有的v∈e，因为[是双目标的，这意味着
f（λu）=λf（u）。
因此，F实际上是一个线性映射，它是独一无二的，因为[是一个双射体]。
定义11.4.给定一个有限维的欧几里得空间e，对于每一个线性映射f:e→e，唯一的线性映射f：e→e，这样
f（u）·v=u·f（v），对于所有u，v∈e
由命题11.8给出的称为f（w.r.t.与内积）的伴随。线性映射f:e→e这样f=f被称为自伴映射。
自伴线性映射具有实特征值，正态基是由特征向量产生的，因而起着非常重要的作用。此外，许多物理问题导致自伴线性映射（以对称矩阵的形式）。
注：如果e上的内积被非简并对称双线性形式_替换，则命题11.8仍然成立。
线性映射，使f−1=f，或等效
F F=F F=ID，
也扮演着重要的角色。它们是线性等轴测或等轴测。旋转是一种特殊的等角图。另一类重要的线性映射是满足该性质的线性映射。
F F=F F，
称为法向线性映射。稍后我们将看到，法向映射总是可以在特征向量的正交基上对角化，但这需要使用厄米特内积（超过c）。
给定两个欧几里得空间e和f，其中e上的内积表示为h−、−i1，f上的内积表示为h−、−i2，给定任何线性映射f:e→f，立即证明命题11.8的证明可以被改编以表明存在唯一的线性映射f：f→e这样
hf（u），vi2=hu，f（v）i1
对于所有u∈e和所有v∈f，线性映射f也被称为f的伴随。
以下属性直接从伴随映射的定义开始：
(1)	对于任何线性图f:e→f，我们有
F=F.
(2)	对于任意两个线性映射f，g:e→f和任意标量λ∈r：
(f	+g）=f+g（λf）=λf。
(3)	如果e、f、g是具有各自内部产物h−、−i1、h−、−i2和h−、−、−i3的欧几里得空间，并且如果f:e→f和g:f→g是两个线性映射，则
(g	_f）=f g。
注：考虑到e的任何基和f的任何基，可以根据f的矩阵和定义内积的革兰氏矩阵来描述f的伴随f的矩阵；见问题11.5。我们将在11.14（2）号提案中对正态基这样做。而且，由于内积是对称的，f的伴随f_也具有f（u）·v=u·f（v）的特征。
对于所有u，v∈e。
11.4正交基底的存在和建造
我们也可以利用定理11.6来证明有限维的欧几里德空间具有正交基。
提案11.9.给定任意非平凡欧几里得空间e的有限维n≥1，e有一个正交基（u1，…，un）。
证据。我们在n上进行归纳，当n=1时，取任意一个非零向量v∈e，它存在于我们假定e非平凡之后，并让
.
如果n≥2，再取任意非零向量v∈e，设
.
考虑与U1相关的线性形式U1。由于u1=06，根据定理11.6，线性形式u1是非零的，其核是超平面h。由于u1（w）=0 iff u1·w=0，超平面h是u1的正交补数。此外，由于U1=06且内积为正定，U1·U1=06，因此，U1∈/h，这意味着E=H Ru1。然而，由于e是有限维n，超平面h的维数为n-1，根据归纳假设，我们可以找到h的正交基（u2，…，un）。现在，由于h和一维空间ru1是正交的，e=h ru1，很明显（u1，…，un）是正交基。S代表E。
作为命题11.9的结果，给定任意一个欧几里得空间的有限维n，如果（e1，…，en）是e的正交基，那么对于任意两个向量u=u1e1+·········+unen和v=v1e1+········+vnen，内积u·v表示为
，
和诺姆库克一样
.
欧几里得空间总是有一个正交基，这意味着任何一个G矩阵都可以写成
g=q>q，
对于一些可逆矩阵q，我们知道在基矩阵的变化中，一个g矩阵变成g0=p>gp。如果与g0对应的基是正交的，则g0=i，因此g=（p−1）>p−1。
有一种更具建设性的方法来证明11.9号提案，使用一种称为格拉姆-施密特正交化程序的程序。除此之外，Gram–Schmidt正交化程序生成矩阵的QR分解，这是数值方法中的一个重要工具。
提案11.10。对于有限维n≥1的任意非平凡欧几里德空间e，从e的任意基（e1，…，en），我们可以构造e的正交基（u1，…，un），其性质是：对于每k，1≤k≤n，族（e1，…，ek）和（u1，…，uk）生成相同的子空间。
证据。我们在n上归纳n=1，让
.
对于n≥2，我们也允许
，
假设（u1，…，uk）是生成与（e1，…，ek）相同子空间的正交系统，对于1≤k<n的每个k，我们注意到矢量
K
U0K+1=EK+1−X（EK+1·UI）用户界面
i＝1
不为空，因为（u1，…，uk）和（e1，…，ek）生成相同的子空间，（e1，…，ek+1）将线性相关，这是荒谬的，因为（e1，…，en）是基础。因此，矢量U0K+1的范数为非零，我们使用以下矢量UK的构造：
，
对于感应步骤
，
其中1≤k≤n−1。很明显，kuk+1k=1，由于（u1，…，uk）是一个正态系统，我们有
，
对于1≤i≤k的所有i，这表明族（u1，…，uk+1）是正交的，由于（u1，…，uk）和（e1，…，ek）生成相同的子空间，从uk+1的定义可以清楚地看出（u1，…，uk+1）和（e1，…，ek+1）生成相同的子空间。这就完成了归纳步骤和命题的证明。
请注意，U0K+1是通过从EK+1减去EK+1本身在已经计算的正交向量U1，…，UK上的投影得到的。然后归一化。
例11.9。对于此过程的特定示例，让e=r3与标准
欧几里得标准。以此为基础
然后
和
.
这意味着
，
还有那个
.
为了完成正交基，归一化得到
.
图11.4给出了该示例的说明。


图11.4：上图显示蓝色的构造与e2在u1上的正交投影垂直，下图显示绿色的构造与u1和u2确定的平面垂直。
评论：
(1)	现在可以很容易地获得QR分解，但我们将此推迟到第11.6节。
(2)	命题11.10的证明也适用于e的可数无穷大基，产生可数无穷大正交正规基。
也应该说，我们提出的格拉姆-施密特正交化程序在数值上不是很稳定，而是应该使用改进的格拉姆-施密特方法。要计算U0K+1，而不是将EK+1投影到U1，…，UK一步即可，最好执行K投影。我们计算如下：
，
其中1≤i≤k−1。这很容易证明。
例11.10。让我们将修改后的Gram–Schmidt方法应用于示例11.9的（e1、e2、e3）基础。唯一的变化是计算。对于修改后的Gram–Schmidt程序，我们首先计算
然后
，
−−
观察U32=U03。见图11.5。
下面的matlab程序实现了修改后的gram-schmidt过程。
函数q=gramschmidt4（e）n=size（e，1）；对于i=1:n q（：，i）=e（：，i）；对于j=1:i-1 r=q（：，j）'*q（：，i）；q（：，i）=q（：，i）-r*q（：，j）；
结束r=sqrt（q（：，i）'*q（：，i））；q（：，i）=q（：，i）/r；结束
如果我们将上述函数应用于矩阵
，


图11.5：上图显示蓝色的构造与E3在U1上的正交投影垂直，下图显示天空蓝色的构造与U2上的正交投影垂直。
输出是矩阵
，
与示例11.9的结果相匹配。
例11.11。如果我们考虑多项式和内积

将格拉姆-施密特正交化程序应用于多项式
1，x，x2，…，xn，…，
作为一个实系数变量多项式的基础，我们得到了一个与勒让德多项式有关的正交多项式Qn（x）。
勒让德多项式pn（x）具有许多优良的性质。它们是正交的，但它们的范数并不总是1。勒让德多项式pn（x）的定义如下。让fn成为函数
Fn（x）=（x2-1）N，
我们定义Pn（x）如下：
p0（x）=1，和，
式中，是fn的第n个导数。
它们也可以归纳地定义为：
.
以下是pn（x）的显式求和：
.
多项式qn与勒让德多项式pn有关，如下：
.
例11.12。考虑具有对称双线性形式的[-1,1]上的多项式

我们把它作为一个练习来证明上面定义了一个内部产品。可以证明，多项式tn（x）由
tn（x）=cos（麻醉剂），n≥0，
（等价地，当x=cosθ时，我们得到tn（cosθ）=cos（nθ））与上述内积正交。这些多项式是切比雪夫多项式。它们的范数不等于1。相反，我们有
，
利用恒等式（cosθ+isinθ）n=cosnθ+isinθ和二项式，我们得到了tn（x）的以下表达式：
.
切比雪夫多项式的归纳定义如下：
t0（x）=1
T1（x）=x
tn+1（x）=2xtn（x）−tn−1（x），n≥1.
利用这些递推方程，我们可以证明
.
多项式tn在区间[-1,1]中有n个不同的根。切比雪夫多项式在近似理论中起着重要作用。它们被用作SUP范数（∞-范数）下连续函数的最佳多项式近似。
后两个例子的内积是形式内积的特例。

其中w（t）是一个权重函数。如果w是一个非零连续函数，使得w（x）≥0开（−1,1），那么上述双线性形式确实是正定的。在近似理论和物理中使用的正交多项式的族是由适当选择权函数w而产生的。除了前面的两个例子外，厄米特多项式对应于w（x）=e−x2，拉盖尔多项式对应于w（x）=e−x，雅可比多项式对应于w（x）。=（1−x）α（1+x）β，带α，β>−1。正交多项式的综合处理可在Lebedev[45]、Sansone[53]和Andrews、Askey和Roy[1]中找到。
我们也可以证明关于正交空间的下列命题。
提案11.11.给定有限维n≥1的任意非平凡欧几里德空间e，对于维k的任何子空间f，f的正交补f具有维n−k，e=f_f_。此外，我们还有f=f。
证据。从命题11.9，子空间f有一些正交基（u1，…，uk）。这个线性独立族（u1，…，uk）可以推广到一个基（u1，…，uk，vk+1，…，vn），通过命题11.10，它可以转化为一个正态基（u1，…，un），其中包含（u1，…，uk）作为f的正态基，现在任何向量w=w1u1+·············+wnun∈e与f正交。i f f w·ui=0，对于每个i，其中1≤i≤k，iff wi=0，对于每个i，其中1≤i≤k。很明显，这表明（uk+1，…，un）是f的基础，因此e=f f，f具有维数n−k。同样，任何向量w=w1u1+··············+wun∈e与f iff w·ui正交。=0，对于每个i，其中k+1≤i≤n，iff wi=0，对于每个i，其中k+1≤i≤n。
因此，（U1，…，UK）是f和f=f的基础。

11.5。线性等轴测（正交变换）
11.5线性等距图（正交变换）
在本节中，我们考虑保留欧几里得范数的欧几里得空间之间的线性映射。这些变换，有时称为刚性运动，在几何学中起着重要作用。
定义11.5.对于任意两个具有相同有限维的非平凡欧几里德空间e和f，它是线性的，而n，函数f:e→f是正交变换，或者是线性等值线，如果
kf（u）k=kuk，对于所有u∈e。
评论：
(1)	线性等值线通常被定义为一个线性图，这样
k f（v）−f（u）k=kv−uk，
对于所有u，v∈e，由于映射f是线性的，这两个定义是等价的。第二个定义只关注于保持向量之间的距离。
(2)	有时，满足定义11.5的条件的线性映射称为度量映射，线性等值线定义为双射度量映射。
一定是线性的），这样等距测量（没有线性这个词）有时被定义为函数f:e→f（不是
k f（v）−f（u）k=kv−uk，
对于所有u，v∈e，即作为保持距离的函数。事实证明，这一要求非常严格。事实上，下一个命题表明，当e和f是有限维时，所有这些定义都是等价的，对于函数f（0）=0。
提案11.12。对于任意两个具有相同有限维n的非平凡欧几里得空间e和f，对于每个函数f:e→f，以下属性是等效的：
（1）f是一个线性图，kf（u）k=k uk，表示所有u∈e；（2）kf（v）−f（u）k=kv−uk，表示所有u、v∈e和f（0）=0；
（3）f（u）·f（v）=u·v，对于所有u，v∈e。
此外，这样的地图是双目标的。
证据。显然，（1）意味着（2），因为在（1）中，假设f是线性的。
假设（2）成立。事实上，我们将证明一个稍强的结果。我们证明如果
k f（v）−f（u）k=kv−uk
对于所有u，v∈e，那么对于任何向量τ∈e，函数g:e→f定义如下：
g（u）=f（τ+u）−f（τ）
对于所有的u∈e是一个线性映射，这样g（0）=0和（3）保持不变。显然，g（0）=f（τ）−f（τ）=0。注意，根据假设
k f（v）−f（u）k=kv−uk
对于所有u，v∈e，我们得出结论
k g（v）−g（u）k=k f（τ+v）−f（τ）−（f（τ+u）−f（τ））k，
=k f（τ+V）−f（τ+U）k，
=kτ+v−（τ+u）k，=kv−uk，
对于所有u，v∈e，因为g（0）=0，通过设置u=0 in
k g（v）−g（u）k=kv−uk，
我们得到kg（v）k=kvk
对于所有的v∈e，换句话说，g既保留距离又保留范数。
为了证明G保留了内积，我们使用了一个简单的事实
2U·V=kuk2+kvk2−ku−vk2
对于所有的u，v∈e，那么既然g保持距离和范数，我们有
2g（u）·g（v）==kkg（u2）+k2k+vkkk2g−（vk）ku2−vkkkg2（u）−g（v）k2英国
=2U·V，
因此，g（u）·g（v）=u·v，对于所有u，v∈e，即（3）。特别是，如果f（0）=0，通过让τ=0，我们得到g=f，f保留标量积，即（3）保持不变。
现在假设（3）成立。因为e是有限维的，所以我们可以为e选取一个正交基（e1，…，e n）。因为f保留内积，（f（e1），…，f（en））也是正交的，因为f也有维数n，所以它是f的基。然后注意，因为（e1，…，en）和（f（e1），…，f（en））是任意u的正交基。我们有

11.5。线性等轴测（正交变换）
和
，
既然F保存了内部产物，这表明
，
证明f是线性的。显然，f保留欧几里得范数，并且（3）意味着
（1）。
最后，如果f（u）=f（v），那么通过线性f（v−u）=0，使kf（v−u）k=0，并且由于f保持规范，我们必须有kv−uk=0，因此u=v。因此，f是内射的，因为e和f具有相同的有限维，f是双射的。
评论：
(i)	维数假设只需证明（3）当f未知为线性时，意味着（1），并证明f是可射的，但证明表明（1）意味着f是可射的。
(ii)	（3）暗示（1）的含义，如果我们也假设f是主观性的，即使e有无限维。
在（2）中，当f不满足条件f（0）=0时，证明f是仿射映射。实际上，以任一向量τ为原点，图G是线性的，并且
f（τ+u）=f（τ）+g（u）表示所有u∈e。
由命题5.15可知，F与相关的线性映射G是仿射的，这一事实值得记录为以下命题。
提案11.13。给定任意两个非平凡欧几里得空间e和f，对于每个函数f:e→f，如果
k f（v）−f（u）k=kv−uk表示所有u，v∈e，
那么F是仿射映射，它的相关线性映射G是一个等值线。
根据11.12号命题，我们通常将“线性等距”简称为“等距”，除非我们要强调我们处理的是向量空间之间的映射。
我们现在将更仔细地看一看有限维欧几里得空间的等距f:e→e。
11.6正交组，正交矩阵
在本节中，我们将探讨正交群和正交矩阵的一些基本性质。
提案11.14。设e为有限维n的任意欧几里德空间，设f:e→e为任意线性映射。以下属性保留：
(1)	线性图f:e→e是一个等距iff。
F F=F F=ID.
(2)	对于e的每一个正交基（e1，…，en），如果f的矩阵是a，则f的矩阵是a的转置a>且f是满足恒等式的等距变换。
a a>=a>a=in，
式中，in表示n阶的单位矩阵，iff形式的列是rn的正态基，iff形式的行是rn的正态基。
证据。（1）线性图f:e→e为等距iff。
f（u）·f（v）=u·v，
对于所有u，v∈e，iff f（f（u））·v=f（u）·f（v）=u·v
对于所有的u，v∈e，这意味着
（f（f（u））−u）·v=0
对于所有u，v∈e，由于内积是正定的，我们必须
F（F（U））−U=0
对于所有的u∈e，也就是说，
F F=ID。
但具有左逆的有限维向量空间的自同态f是同构的，所以f f=id。逆是通过向后执行上述步骤而建立的。
（2）如果（e1，…，en）是e的正交基，则a=（aij）是f的矩阵，b=（bij）是f的矩阵。因为f的特点是
F（U）·V=U·F（V）
对于所有u，v∈e，如果w=w1e1+·············································
bj i=f（ei）·ej=ei·f（ej）=aij，
11.6。正交群，正交矩阵
对于所有i，j，1≤i，j≤n。因此，b=a>。现在，如果x和y是基上的任意矩阵（e1，…，en），通常用xj表示x的jth列，同样地，对于y，一个简单的计算表明
x= y＝（Xi·y j）1，i，jωn，然后立即验证，如果x= y= a，则
A>A=AA>=In
如果列向量（a1，…，an）形成正交基。因此，从（1）我们可以看到（2）是清晰的（也因为a的行是>的列）。
命题11.14表明一个等距f的倒数是它的伴随f。所有实n×n矩阵的集合都用mn（r）表示。提案11.14还激励了以下定义。
定义11.6.实n×n矩阵是正交矩阵，如果
a a>=a>a=in.
备注：很容易看出，条件a a>=in、a>a=in和a−1=a>是等效的。对于任意两个正交基（u1，…，un）和（v1，…，vn），如果p是基矩阵从（u1，…，un）到（v1，…，vn）的变化，因为p列是矢量vj相对于基（u1，…，un）的坐标，并且因为（v1，…，vn）是正交的，p列是正交的。，根据命题11.14（2），矩阵p是正交的。
命题11.12（3）的证明还表明，如果f是一个等距测量，那么正交基（u1，…，un）的图像是一个正交基。学生经常问为什么正交矩阵不被称为正交矩阵，因为他们的列（和行）是正交基！我没有很好的答案，但是等距线确实保持了正交性，并且正交矩阵对应于等距线。
回想一下，线性映射f:e→e的行列式det（f）独立于e中基的选择，而且，对于每个矩阵a∈mn（r），我们都有det（a）=det（a>，对于任意两个n×n矩阵a和b，我们都有det（ab）=det（a）det（b）。那么，如果f是一个等距测量，并且a是关于任何正交基的矩阵，aa>=a>a=in表示det（a）2=1，也就是说，det（a）=1或det（a）=1。很明显，维数n的欧几里德空间的等距构成一个群，行列式+1的等距构成一个子群。这导致了以下定义。
定义11.7.给定一个维数为n的欧几里得空间e，等距图f:e→e构成一个gl（e）的子群，当e=rn时，用o（e）或o（n）表示，称为e的正交群。对于每个等距f，我们有det（f）=±1，其中det（f）表示f的行列式。这样的等距，det（f）=1被称为旋转，或适当的等距，或适当的正交变换，它们形成特殊线性群sl（e）（和o（e））的子群，用so（e）表示，或所以（n）当e=rn时，称为特殊正交群（e的）。如Det（f）=-1的等轴测称为不当等轴测，或不当正交变换或翻转变换。
11.7罗德里格斯公式
当n=3且a是一个斜对称矩阵时，就可以为ea求出一个显式公式。对于任意3×3实斜对称矩阵
，
如果我们让θ=√a2+b2+c2和
，
然后我们得到了以下结果，即罗德里格斯公式（1840）。用so（n）表示n×n次对称矩阵的（实）向量空间。
提案11.15。指数图exp:so（3）→so（3）由下式给出

或者，等价地，通过

如果θ=06，则e03=i3。
证明草图。首先要注意
a2=−θ2i3+b，
自从
0−C B 0−C B−C2−B2 BA CA A2=C 0−A C 0−A=AB−C2−A2 CB
−B A 0−B A 0 AC CB−B2−A2
−A2−B2−C2 0 0 A2 BA CA
=0−a2−b2−c2 0+ab b2 cb
0 0−A2−B2−C2交流断路器C2
=−θ2i3+b，
还有那个
ab=ba=0.
从上面可以推断
A3=−θ2a，
11.7。罗德里格斯公式和任何k≥0，
A4K+1=θ4KA，
A4K+2=θ4KA2，A4K+3=−θ4K+2A，
A4K+4=−θ4K+2A2。
然后通过编写ea的幂级数和对项进行重新分组来证明所期望的结果，从而得到cosθ和sinθ的幂级数。特别地

如要求。
上面的公式是表达由向量（a，b，c）和角度θ指定的轴旋转的众所周知的公式。
罗德里格斯公式可以证明指数图exp:so（3）→so（3）是可预测的。
给定任意旋转矩阵r∈so（3），我们有以下情况：
(1)	案例r=i是微不足道的。
(2)	如果r=6 i且tr（r）=6−1，则
.
（回想一下，tr（r）=r11+r22+r33，矩阵r的轨迹）。
然后有一个唯一的斜对称b，对应的θ满足0<θ<π，这样eb=r。
(3)	如果r=6i和tr（r）=-1，那么r是一个角度π的旋转，事情更复杂，但可以找到矩阵b。我们将这部分作为一个很好的练习：参见问题16.8。
如上图所示，在SO（3）中计算旋转对数在运动学、机器人学和运动插值中有应用。
作为格拉姆-施密特正交化过程的直接推论，我们得到了可逆矩阵的二维分解。
11.8可逆矩阵的QR分解
既然我们有了正交矩阵的定义，我们就可以解释Gram–Schmidt正交化过程如何立即生成矩阵的QR分解。
定义11.8.给定任意实n×n矩阵a，a的q r分解是n×n矩阵（q，r）的任意对，其中q是正交矩阵，r是上三角矩阵，a=qr。
注意，如果a不可逆，那么r中的某个对角线入口必须为零。
提案11.16。给定任意实n×n矩阵a，如果a是可逆的，则有一个正交矩阵q和一个上三角矩阵r，其中a=qr为正对角项。
证据。我们可以将a的列看作向量a1，…，in en。如果a是可逆的，那么它们是线性无关的，我们可以应用命题11.10，用格拉姆-施密特正交化程序生成正交基。记住，我们构造向量qk和q0k如下：
，
对于感应步骤
，
其中1≤k≤n−1。如果我们用qi和q0i来表示向量ak，我们得到三角形系统。
网络错误	网络错误
网络错误	网络错误
网络错误	网络错误
网络错误	网络错误
网络错误	网络错误	网络错误
11.8。可逆矩阵的二维分解
Rkk=kq0kk，rij=aj·qi（右侧i和j的倒转是有意的！），其中1≤k≤n，2≤j≤n，1≤i≤j−1，且qij为qj的第i个分量，我们注意到aj的第i个分量aij由aij=r1jqi1+····+rijqii+····+rj jqij=qi1r1j+····+qiirij+····+qijrj j给出。
如果我们让q=（qij），列为qj分量的矩阵，和r=（rij），上面的方程表明a=qr，其中r是上三角形。对角线条目RKK=KQ0KK=AK·QK确实为正。
读者应该在2×2和3×3矩阵的一些具体示例上尝试上述步骤。
评论：
(1)	因为r的对角线项是正的，所以可以看出q和r是唯一的。一般来说，如果a是可逆的，如果a=q1r1=q2r2是a的两个qr分解，那么
.
矩阵是正交的，很容易看出R1r2-1是上三角形。但是一个正交的上三角矩阵必须是一个对角线矩阵d，其对角线项为±1，所以q2=q1d，r2=dr1。
(2)	即使a不可逆，qr分解也保持不变。在这种情况下，R在对角线上有一些零。然而，需要另一种证明。我们将使用户主矩阵给出一个很好的证明（见命题12.4，以及Strang[63，64]、Golub和van Loan[30]、Trefethen和Bau[68]、Demmel[16]、Kincaid和Cheney[39]或Ciarlet[14]）。
为了获得更好的数值稳定性，最好使用改进的格拉姆-施密特方法来实现二维因子分解法。下面是一个使用修改后的gram-schmidt实现qrfactorization的matlab程序。
函数[q，r]=qrv4（a）n=大小（a，1）；对于i=1:n q（：，i）=a（：，i）；对于j=1:i-1
r（j，i）=q（：，j）'*q（：，i）；
Q（：，I）=Q（：，I）-R（J，I）*Q（：，J）；结束
r（i，i）=sqrt（q（：，i）×q（：，i））；
q（：，i）=q（：，i）/r（i，i）；结束
例11.13。考虑矩阵
.
为了确定a的qr分解，我们首先使用gram-schmidt正交化程序计算q=（q1q2q3）。按定义
，
从那以后，我们发现
.
因此，。最后，
，
这意味着。根据提案11.16，为了确定R，我们
需要计算

总之，我们发现
而且。
11.8。可逆矩阵的二维分解
例11.14。QR分解的另一个例子是
.
例11.15。如果我们将上述matlab函数应用于矩阵
网络错误		网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误	
	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误
和
网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误

备注：matlab函数q r由[q，r]=qr（a）调用，不一定返回对角线项为正的上三角矩阵。
QR分解为求解线性方程组提供了一种高效且数值稳定的方法。实际上，给定系统ax=b，其中a是n×n可逆矩阵，写a=qr，因为q是正交的，我们得到
Rx=q>b，
由于r是上三角形，我们可以通过高斯消去，先求解最后一个变量xn，将其值代入系统，然后求解xn−1等来解决它。qr分解在解决最小二乘问题中也非常有用（我们将在第章中回到这一点）。21），以及寻找特征值；见第17章。它可以很容易地适应A是一个具有独立柱的矩形m×n矩阵的情况（因此，n≤m）。在这种情况下，q不是完全正交的。它是一个m×n矩阵，其列是正交的，r是一个可逆的n×n上三角矩阵，具有正对角项。关于QR的更多信息，请参见Strang[63，64]、Golub and van Loan[30]、Demmel[16]、Trefethen and Bau[68]或Serre[57]。
QR分解的一个令人惊讶的结果是由于Hadamard而产生的一个著名的行列式不等式。
提案11.17。（hadamard）对于任何实n×n矩阵a=（aij），我们有
及。
此外，如果a在左不等式中有零行，或者在右不等式中有零列，或者a是正交的，则等式成立。
证据。如果Det（a）=0，则不等式是平凡的。此外，如果右侧也是0，则某列或某行为零。如果det（a）=06，那么我们可以将a作为a=q r，其中q是正交的，r=（rij）上三角带正对角线条目。
因为q是正交的，所以（q）=±1，所以
.
因为q是正交的，所以它保留了欧几里德范数，所以
，
这意味着
.
另一个不等式是用>替换a得到的。最后，如果det（a）=06且等式成立，那么我们必须

这只能在a是正交的情况下发生。
哈达玛不等式的另一种形式适用于对称半正定矩阵。
提案11.18。（hadamard）对于任意实n×n矩阵a=（aij），如果a是对称的
正半定的，那么我们有
.
此外，如果a是正定的，则等式认为iff a是对角矩阵。
11.9。欧几里得几何的一些应用
证据。如果Det（a）=0，则不等式是平凡的。否则，a是正定的，根据定理7.10（Cholesky因式分解），有一个唯一的上三角矩阵b，其对角项为正，因此
A=B>B。
因此，det（a）=det（b>b）=det（b>）det（b）=det（b）2。如果我们把哈达玛不等式（命题11.17）应用于b，我们得到
.（）
然而，a=b>b的对角线ajj恰好是平方规范。
因此，通过平方（），我们得到
.
如果det（a）=06且相等，则b必须是正交的，这意味着b是对角矩阵，a也是。
我们从第一个（命题11.17）推导出第二个阿达玛不等式（命题11.18）。我们把它作为一个练习来证明第一个阿达玛不等式可以从第二个阿达玛不等式中推导出来。
11.9欧几里得几何的一些应用
欧几里得几何学在计算几何学中有应用，特别是沃罗诺伊图和Delaunay三角测量。反过来，Voronoi图在运动规划中也有应用（见O'Rourke[49]）。
欧几里得几何在矩阵分析中也有应用。回想一下，如果一个实n×n矩阵a等于它的转置a>则它是对称的。对称矩阵的一个最重要的性质是，它们具有真实的特征值，并且它们可以由正交矩阵对角化（见第16章）。这意味着对于每个对称矩阵A，都有一个对角矩阵D和一个正交矩阵P，这样
a=pdp>。
尽管对角化一个任意矩阵并不总是可能的，但是有许多涉及正交矩阵的分解是非常有实际意义的。例如，对于每个实矩阵A，都有QR分解，即实矩阵A可以表示为
A=qr，
其中q是正交的，r是上三角矩阵。如我们在第11.8节中所见，这可以通过使用户主矩阵（如第12.2节所示）从Gram–Schmidt正交化程序中获得，或者更好。还有极分解，也就是说一个实矩阵a可以表示为
A=qs，
其中q是正交的，s是对称的半正定的（这意味着s的特征值是非负的）。这种分解在连续体力学和机器人学中很重要，因为它将拉伸和旋转分开。最后，还有奇异值分解，简称SVD，它表示一个实矩阵A可以表示为
a=v du>，
其中u和v是正交的，d是带非负项的对角矩阵（见第20章）。这种分解导致了伪逆的概念，它在工程中有许多应用（最小二乘解等）。为了更好地展示所有这些概念，我们强烈推荐Strang[64、63]、Golub和van Loan[30]、Demmel[16]、Serre[57]和Trefethen和Bau[68]。
高斯和勒让德在1800年左右发明了最小二乘法，这是欧几里德几何的另一个伟大应用。粗略地说，该方法用于求解不一致线性系统ax=b，其中方程的个数大于变量的个数。由于这通常是不可能的，最小二乘法包括找到一个最小化欧几里得范数kax−bk2的解x，也就是“误差”的平方和。结果是，总是有一个最小范数最小化kax−bk2的唯一解x+，并且t是平方系统的一个解
a>ax=a>b，
称为正态方程组。解x+可以通过使用户变换中的qrdecomposition或使用矩阵的伪逆概念来找到。利用SVD分解可以计算伪逆。最小二乘法在计算机视觉中应用广泛。关于最小二乘法和伪逆法的更多细节，请参见第21章。
11.10总结
本章的主要概念和结果如下：
•	双线性形式；正定双线性形式。
•	内积，标量积，欧几里得空间。
•	与双线性形式有关的二次型。
11.10.总结
•	欧几里得空间。
•	二次型的极性形式。
•	与内积相关的革兰氏矩阵。
•	柯西-施瓦兹不平等；明可夫斯基不平等。
•	平行四边形定律。
•	正交性，正交补码f正交族。
•	Theorem 11.6.音乐同构[：e→e和]：e→e（当e是有限维时）；
•	线性映射的伴随（关于内积）。
•	有限维欧几里得空间中正交基的存在性（命题11.9）。
•	格拉姆-施密特正交化程序（提案11.10）。
•	勒让德和切比雪夫多项式。
•	线性等轴测（正交变换、刚性运动）。
•	正交群，正交矩阵。
•	表示线性映射f的邻接tf.f的矩阵是矩阵的转置
•	正交群O（N）和特殊正交群SO（N）。
•	可逆矩阵的二维分解。
•	任意实矩阵的阿达玛不等式。
•	对称半正定矩阵的阿达玛不等式。
•	罗德里格斯公式的旋转在SO（3）。
11.11问题
问题11.1。e是维2的向量空间，并让（e1，e2）作为e的基础。证明如果a>0和b2−ac<0，那么双线性形式定义如下：
⑨（x1e1+y2e2，x2e1+y2e2）=axix2+b（x1y2+x2y1）+cy1y2
是欧几里得内积。
问题11.2。让c[a，b]表示连续函数集f:[a，b]→r。给定任意两个函数f，g∈c[a，b]，让

证明上述双线性形式确实是欧氏内积。问题11.3。考虑内部产品

关于向量空间C的问题11.2[−π，π]。证明这一点
1，
sinpx、sinqx=
0，如果p=6 q，p，q≥1，
1，
COSPX、COSQX=
如果p=6 q，p，q≥0，
Xinpx，cosqxi=0，
对于所有p≥1和q≥0，以及。
问题11.4。证明以下矩阵是正交和斜对称的：
.
问题11.5。设e和f为两个有限欧几里得空间，设（u1，…，un）为e的基，设（v1，…，vm）为f的基。对于任何线性映射f:e→f，如果a是f w.r.t的矩阵，则基（u1，…，un）和b是f_w.r.t的矩阵。如果g1是内部prod的gram矩阵，则基（v1，…，vm）e上的UCT（w.r.t.（u1，…，un）），如果g2是f上内积的g矩阵（w.r.t.（v1，…，vm）），那么
B=G−1 1A>G2。

问题11.6.设A为可逆矩阵。证明如果a=q1 r1=q2 r2是a的两个qr分解，如果r1和r2的对角线项为正，则q1=q2和r1=r2。
问题11.7。证明了第一个阿达玛不等式可以从第二个阿达玛不等式中推导出来。
问题11.8。设e为有限维的实向量空间，n≥1。假设e的两个基（u1，…，un）和（v1，…，vn）具有相同的方向iff det（p）>0，其中p是基矩阵从（u1，…，un）和（v1，…，vn）的变化，即其jth列由基（u1，…，un）上的vj坐标组成的矩阵。
(1)	证明具有相同方向是两个等价类的等价关系。
矢量空间的方向e是e的任何固定基的选择，如（e1，…，en）。任何其他基（v1，…，vn）的方向与（e1，…，en）（并被称为正或正）iff det（p）>0相同，否则被称为（e1，…，en）（或负）的方向相反。ve或间接），其中p是基矩阵从（e1，…，en）到（v1，…，vn）的变化。定向向量空间是指具有选定方向（正基）的向量空间。
(2)	设b1=（u1，…，un）和b2=（v1，…，vn）为两个正交基。对于任何向量序列（w1，…，wn），在e中，让detb1（w1，…，wn）是矩阵的行列式，其列是wj在基b1上的坐标，与detb2（w1，…，wn）相似。
证明如果b1和b2方向相同，那么
DETB1（w1，…，wn）=DETB2（w1，…，wn）。
给定任意定向向量空间，e，对于任意向量序列，（w1，…，wn），在e中，表示e的所有正正交基的公共值detb（w1，…，wn），b，of e。
λe（w1，…，wn）
称为（w1，…，wn）的体积形式。
(3)	对于任意n−1向量，w1，…，wn−1，给定维数n的任何欧几里德定向向量空间e，在e中，检查映射
x 7→λe（w1，…，wn-1，x）
是线性形式。然后证明有一个唯一的向量，表示为w1×·····×wn-1，这样
λe（w1，…，wn-1，x）=（w1×····×wn-1）·x，
对于交叉积inx∈e的Alla推广，向量w1×······×wn−r13称为（n=3时）。（w1，…，wn−1）的交叉积。问题11.9。给定n≥p维数的欧氏空间e中的p向量（u1，…，up），向量（u1，…，up）的g行列式（或gramian）是行列式。
Gram
（1）证明
克（u1，…，un）=λe（u1，…，un）2.
暗示。如果（e1，…，en）是正态基，a是该基上向量（u1，…，un）的矩阵，那么det（a）2=det（a>a）=det（ai·aj），
式中，ai表示矩阵A的第i列，（ai·aj）表示条目为ai·aj的n×n矩阵。（2）证明ku1×·····×un−1k2=克（u1，…，un−1）。
暗示。设w=u1×····×un-1，观察
λe（u1，…，un-1，w）=hw，wi=kwk2，
让我们看看
kwk4=λe（u1，…，un-1，w）2=克（u1，…，un-1，w）=g（u1，…，un-1）kwk2。
问题11.10。设_：e×e→r为有限维n实向量空间e上的双线性形式。给定e的任何基（e1，…，en），设a=（aij）为定义的矩阵，以便
aij=_（ei，ej）
1≤i，j≤n。我们称之为_w.r.t.矩阵的基础（e1，…，en）。
(1)	对于任意两个向量x和y，如果x和y表示x和y w.r.t坐标的列向量，则基（e1，…，en）证明
⑨（x，y）=x>y。
(2)	回想一下，如果a=a>是对称矩阵。证明了当a是对称矩阵时，ω是对称的。
(3)	如果（f1，…，fn）是e的另一个基，而p是基矩阵从（e1，…，en）变为（f1，…，fn），则证明ωw.r.t.的基（f1，…，fn）是p>ap。
所有矩阵的共同秩表示_，称为_的秩。
问题11.11.设a:e×e→r为有限维n的实向量空间e上的对称双线性形式。如果a（x，y）=0，则两个向量x和y称为共轭或正交w.r.t.a。这个问题的主要目的是证明有一个向量的基础是成对共轭w.r.t._。
(1)	证明如果所有x∈e的_（x，x）=0，则_在e上等于零。
否则，我们可以假设有一个向量x∈e，这样，（x，x）=0.6
利用归纳法证明有一个向量（u1，…，un）的基础是成对共轭w.r.t.。
暗示。对于导入步骤，按以下步骤进行。设（u1，e2，…，en）为e的一个基础，其中（u1，u1）=06。证明存在标量λ2，…，λn，这样每个向量
vi=ei+λiu1
是u1 w.r.t.的共轭，其中2≤i≤n，并且（u1，v2，…，vn）是基础。
(2)	设（e1，…，en）为成对共轭w.r.t._的矢量的基础，并假定它们是这样排列的：
，
⑨（I，EI）=
如果r+1≤i≤n，则为0，
式中，r为_级。显示出_w.r.t.（e1，…，en）的矩阵是对角矩阵，并且
，
在哪里和
证明对于每一个对称矩阵A，都有一个可逆矩阵P，这样
p>ap=d，
其中d是对角矩阵。
(3)	证明有一个整数p，0≤p≤r（其中r是_的秩），这样，对于每一个基（u1，…，un）的向量的精确p向量，即成对共轭w.r.t._（西尔维斯特惯性定理），_（ui，ui）>0。
按以下步骤进行。假设在（u1，…，un）的基础上，对于任何x∈e，我们有
，
式中，在（v1，…，vn）的基础上，对于任何x∈e，我们有
，
式中，αi>0，βi>0，1≤i≤r。
假设p>q，得出一个矛盾。首先考虑子空间f中的x
（U1，…，向上，UR+1，…，UN）
并观察，如果x=06，（x，x）≥0。接下来考虑子空间g中的x
（VQ+1，…，Vr）
并观察，如果x=06，_（x，x）<0。证明f g是非平凡的（即包含一些非零向量），并得出一个矛盾。这意味着p≤q.完成证明。
这对（P，R−P）被称为_的签名。
（4）对称双线性形式，如果对于每一个x∈e，定义为：如果（x，x）=0，则x=0。
网络错误	
	网络错误
网络错误
网络错误
网络错误		
网络错误	网络错误	网络错误	
	网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
	网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误		
证明对称双线性形式是确定的，如果它的签名是（n，0）或（0，n）。换句话说，对称定双线性形式具有秩n，并且是正的或负的。问题11.12。考虑为所有i，j定义的n×n矩阵ri，j，其中1≤i<j≤n
（1）证明ri，j是旋转矩阵。使用矩阵RIJ构成
n×n次对称矩阵.i，j
(2)	考虑为所有i，j定义的n×n对称矩阵s，其中1≤i<j≤n和n≥3，因此只有非零项
si，j（i，j）=1
si，j（i，i）=0
si，j（j，i）=1
si，j（j，j）=0
si，j（k，k）=1，1≤k≤n，k=6 i，j，
网络错误						
网络错误									
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误	网络错误	网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误
网络错误
网络错误
网络错误
网络错误	网络错误	网络错误	网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
网络错误
如果i+2≤j，那么si，j（i+1，i+1）=-1，否则如果i>1，j=i+1，那么si，j（1,1）=-1，
注意，si，j有一个对角线入口等于−1。证明了si，j是旋转矩阵。
利用问题2.15和si，j一起构成n×n对称矩阵的基础。
(3)	证明了当n≥3时，so（n）中所有矩阵的线性组合集合都是n×n矩阵的空间mn（r）。
证明了当n≥3且矩阵a∈mn（r）与所有旋转矩阵相乘时，则a与所有矩阵在mn（r）中相乘。n=2会发生什么？
问题11.13。设a为n×n实可逆矩阵。证明如果a=q1 r1和a=q2 r2是a的两个qr分解，其中r1和r2是上三角形，有正对角项，则q1=q2和r1=r2。
问题11.14。（1）设h为方程给出的Rn中的仿射超平面。
a1x1+·····+anxn=c，
对于一些i，ai=06，1≤i≤n。平行于h的线性超平面h0由方程a1x1+····+anxn=0给出，
我们认为向量y∈rn与h iff y正交（或垂直），y与h0正交。设h为h与穿过原点并垂直于h的线的交点。
证明h的坐标由
.
(2)	对于任意点p∈h，证明khk≤kpk。因此，很自然地将从原点o到超平面h的距离d（o，h）定义为d（o，h）=khk。证明这一点
.
(3)	设为平面上n≥3个点的有限集合（r2）。证明如果对于每一对不同的点pi，pj∈s，存在第三个点pk∈s（与pi和pj不同），使得pi，pj，pk属于同一（仿射）线，则s中的所有点都属于同一（仿射）线。
暗示。以矛盾的方式进行，并使用最低限度的论据。这要么是∞困难，要么相对容易，取决于你如何进行！
问题11.15。（R2中闭合多边形的空间，在Hausmann和Knutson之后）
平面上的开放多边形p是点vi∈r2的序列p=（v1，…，vn+1），称为顶点（n≥1）。闭合多边形，简称多边形，是一个开放多边形p=（v1，…，vn+1），因此vn+1=v1。与开放（或封闭）多边形P=（v1，…，vn+1）相关的边向量序列（e1，…，en）定义为
ei=vi+1−vi，i=1，…，n.
因此，闭合或开放多边形也由一对（v1，（e1，…，en））定义，顶点由
vi+1=vi+ei，i=1，…，n.
观察多边形（v1，（e1，…，en））是否闭合iff
e1+····+en=0.
由于每个多边形（v1，（e1，…，en））都可以由−v1转换，因此v1=（0,0），我们可以假设我们的多边形是由一系列边向量指定的。回想一下，平面r2通过同构与c同构
（x，y）7→x+iy.
我们将用复数wk=ak+ibk的平方来表示每个边向量ek。因此，每个复数序列（w1，…，wn）定义一个多边形（即（
这种表示是多对一的：序列（±w1，…，±wn）描述同一个多边形。对于每一个复数序列（w1，…，wn），我们将向量对（a，b）与a，b∈rn联系起来，这样如果wk=ak+ibk，那么
A=（A1，…，A），B=（B1，…，Bn）。
地图
（w1，…，wn）7→（a，b）
显然是一个双射，所以我们也可以用向量对（a，b）来表示多边形。
(1)	证明了当a·b=0且kak2=kbk2.n n时，用一对向量（a，b）∈rn×rn表示的多边形p是闭的。
(2)	给定一个由一对向量（a，b）表示的多边形p∈r×r，多边形p的长度l（p）由l（p）=w1 2+···········wn 2定义，wk=ak+ibk。证明这一点
.
由（a）和（b）推导出，具有n条边的长度为2的每个闭合多边形由n×2矩阵a表示，这样a>a=i。
注：所有n×2实矩阵a的空间，其中a>a=i是一个称为Stiefel流形s（2，n）的空间。
(3)	回想一下，在r2中，矩阵指定的角θ的旋转

用复数表示
z 7→zeiθ。
设p为一对向量（a，b）表示的多边形∈rn×rn。证明将旋转rθ应用于p的每个顶点wk2=（ak+ibk）2得到的多边形rθ（p）是由向量对指定的。
.
(4)	关于x轴的反射ρx对应于地图
Z 7→Z，
其矩阵是，
.
证明在每个顶点wk2上应用反射ρx得到的多边形ρx（p）=
（ak+ibk）p的2由向量对指定
.
(5)	设q∈o（2）为任意等距，使det（q）=-1（反射）。证明存在旋转r−θ∈so（2），这样
Q=ρx r−θ。
证明矩阵给出的等距q
，
是与角θ/2（方程y=tan（θ/2）x）对应的直线的反射。
证明将反射q=ρx r−θ应用于p的每个顶点wk2=（ak+ibk）2得到的多边形q（p）由一对向量指定。
.
(6)	定义s（2，n）上的等价关系，这样如果a1，a2∈s（2，n）是任何n×2矩阵，那么
a1～a2 iff a2=a1 q，对于某些q∈o（2）。
证明商g（2，n）=s（2，n）/～与rn的所有二维子空间（平面）集是双射的。空间G（2，n）被称为格拉斯曼流形。
证明在o（2）（旋转和反射）中，长度为2的n边闭合多边形在o（2，n）中由平面表示。
问题11.16。（1）找出两个对称矩阵a和b，使ab不对称。（2）找出两个矩阵a和b，使
eaeb=6个ea+b。
暗示。尝试
而且，
使用罗德里格斯公式。
（3）找到一些方阵a，b，使ab=6ba，然而
eaeb=ea+b。
暗示。寻找2×2的零迹矩阵，使用问题8.15。
问题11.17。给定一个k域和任意一个非空集i，设k（i）为所有函数λ：i→k的笛卡尔积ki的子集，并有有限的支持，这意味着除有限多个i∈i外，所有函数的λ（i）=0。我们通常将由λ定义的函数表示为（λi）i∈i，而调用是一个独立的族。由i固定。我们用一个标量定义加法和乘法，如下所示：
（λi）i∈i+（μi）i∈i=（λi+μi）i∈i，
和α·（μi）i∈i=（αμi）i∈i。
(1)	检查k（i）是否是向量空间。
(2)	如果i是任何非空子集，对于任何i∈i，我们用ei表示族（ej）j∈i的定义是

证明了该族（k ei）i∈i是线性独立的，且具有跨距（i）。当我是有限的，比如基数k（i），它是n的基础，然后证明
（i）称为k的规范基，k（i）同构于kn。
（3）函数_：i→k（i），使得（i）=ei对于每个i∈i，显然是一个注入。
对于任何其他向量空间f，对于任何函数f:i→f，证明

线性图f:k（i）→f，这样

F=F_，
如下图所示：
我是CCCC/CK！（FI）。
f
f
我们称之为向量空间k（i）集i自由生成的向量空间。
问题11.18。（无限维的一些陷阱）让e是自然数集自由生成的向量空间，n=0,1,2，…，并让（e0，e1，e2，…，en，…）作为它的规范基础。我们定义了函数，使得
如果i，j≥1，
，
我们通过双线性度将_扩展到函数_：e×e→k，这意味着如果u=pi∈nλiei和v=pj∈nμjej，那么
，
但要记住，λi=06和μj=06仅适用于有限多个指数i，j。
(1)	证明_是肯定的，因此它是e上的内积。如果我们将1/2j改为1（或任何常数），会发生什么？
(2)	设h为e的子空间，由族（e i）i≥1所跨越，e中的超平面。
H和H，并证明
H=6小时。
(3)	设u为族（e2i）i≥1所跨越的e的子空间，设v为族（e2i−1）i≥1所跨越的e的子空间。证明这一点
U=V
V=U
u=u
V=V，
然而
（U V）=6 U+V
和
（U+V）=6 U+V.
如果w是e0和e1所跨越的子空间，证明
（W H）=6 W+H。
(4)	考虑e的对偶空间e，让（e i）i n是基（ei）i n的对偶形式的族，检查该族（e i）i n是线性独立的。（5）设f e为以下定义的线性形式：
f（ei）=1表示所有i∈n。
证明f不在e i所跨越的子空间内。如果f是e_i和f所跨越的e_的子空间，则找到f0和f00，并证明
F=6 f00。