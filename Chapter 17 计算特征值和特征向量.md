第十七章

# 计算特征值和特征向量

在求解线性系统问题之后，计算实矩阵或复矩阵的特征值和特征向量的问题是数值线性代数中最重要的问题之一。存在几种方法，其中我们提到Jacobi、Givens——户主、分而治之、QR迭代和Rayleigh——Ritz；见Demmel[16]、Trefetten和Bau[68]、Meyer[48]、Serre[57]、Golub和van Loan[30]和Ciarlet[14]。通常，对于特殊类型的矩阵（如对称矩阵），存在性能更好的方法。

在理论上，给定一个n×n复矩阵a，如果我们可以计算一个Schur形式a=u t u，其中t是上三角，u是单位的，我们就可以得到a的特征值，因为它们是t中的对角项。然而，这需要求多项式的根，但要求出方法这是众所周知的数值非常不稳定，所以这不是一个实际的方法。

一个常见的范例是构造一个矩阵序列（pk），使得ak=pk−1apk在某种意义上收敛到一个特征值容易确定的矩阵。例如，ak=pk−1apk可能在极限处变成上三角形。此外，pk通常是“nice”矩阵的乘积，例如正交矩阵。

对于一般的矩阵，即非对称矩阵，20世纪60年代初由于Rutishauser、Francis和Kublanovskaya的影响，QR迭代算法是计算特征值最有效的算法之一。Golub和Uhlig[29]对QR算法的历史进行了精彩的描述。QR算法构造了一个矩阵序列（AK），其中AK+1是通过对AK执行QR分解AK=QKRK，然后设置AK+1=RKQK，交换QK和RK的结果从AK获得的。立即证实，ak+1=q kakqk，因此ak和ak+1具有相同的特征值，即a的特征值。

该算法的基本版本在具有多个具有相同模的特征值的矩阵中遇到困难（它可能循环或不“收敛”到上三角矩阵）。有一些方法可以解决这些问题，但为了便于解释，我们首先提出了一个简化版的二维码算法，我们称之为基本二维码算法。

五百七十七

在输入矩阵A可对角化且特征值不为零且具有明显模性的限制性假设下，证明了基本QR算法的收敛定理。证明了严格低于对角的AK部分收敛到零，AK的对角项收敛到A的特征值。

由于qr方法的收敛性主要取决于一个事实，即对角线下的ak部分变为零，因此，如果我们可以用一个类似的矩阵u au替换a，该矩阵u au很容易从a计算出来，并且在对角线下有大量的零，这将是非常可取的。事实证明，有一种方法可以构造一个几乎是三角形的矩阵h=u au，除了它在主对角线下面可能有一个额外的非零对角线。这种矩阵称为Hessenberg矩阵，将在第17.2节中讨论。一个n×n的可对角化Hessenberg矩阵h，其性质为i=1，…，n−1（这种矩阵称为无约矩阵）具有其特征值都不同的优良性质。由于每一个海森堡矩阵都是一个由海森堡块组成的块对角矩阵，所以计算海森堡矩阵的特征值就足够了。有一个特别有趣的例子：对称（或厄米特）正定三对角矩阵。这样的矩阵必须具有实正的特征值，因此QR算法收敛到一个对角矩阵。

在第17.3节中，我们考虑了使基本QR方法更实用、更有效的技术。第一步是将原始输入矩阵A转换为类似的Hessenberg形式的矩阵H，并将QR算法应用于H（实际上，应用于H的未减少块）。加速收敛的第二个关键因素是增加移位。

移动是以下步骤：选择一些σk，希望接近a（一般来说，λn）的特征值，qr因子ak-σki as

AK−σki=qkrk，

然后形成

AK+1=RKQK+σki。

很容易看出我们还有。明智地选择σk可以大大加快收敛速度。如果h是实的，并且有一对复共轭特征值，我们可以执行双移位，并且可以安排我们在实算术中工作。

提高效率的最后一步是计算，甚至不执行AK−σki的QR因子分解。这可以在AK是非公爵海森堡时完成。这种方法称为隐式移位的QR迭代。还有一个带有隐式双移位的QR迭代版本。

如果矩阵A的维数非常大，我们可以通过使用截断形式的约简来找到A的一些特征值的近似值，这种约简形式通常是由于阿诺迪和兰佐斯在对称（或厄米提亚）三对角情况下的约简。第17.4节讨论了Arnoldi迭代。如果a是m×m矩阵，对于比m小得多的矩阵，其思想是生成完整的Hessenberg矩阵h（这样a=u h u）的n×n Hessenberg子矩阵hn，该子矩阵由其前n行和n列组成；也生成不由u的前n列组成的矩阵。瑞利-里兹方法包括


 

用位移的QR-方法计算hn的特征值。这些特征值称为Ritz值，是A特征值的近似值。通常首先找到极端特征值。

Arnoldi迭代也可以看作是计算krylov子空间的正态基的一种方法，即（b，ab，…，anb）所跨越的子空间kn（a，b）。我们也可以使用Arnoldi迭代，通过最小化所有xn的kb−axnk2，找到线性方程ax=b的近似解，即krylov空间kn（a，b）。第17.5节讨论了一种叫做gmres的方法。

第17.6节讨论了H是对称（或厄米特）三对角矩阵的特殊情况。在这种情况下，Arnoldi的算法变成了Lanczos的算法。它比Arnoldi迭代更有效。

我们通过讨论计算单个特征向量和单个特征值的两种经典方法来结束本章：功率迭代和逆（功率）迭代；参见第节

17.7。

## 17.1基本QR算法

假设a是一个n×n矩阵，它假定是对角化的和可逆的。基本的QR算法使用两个非常简单的步骤。从a1=a开始，我们构造矩阵（ak）、（qk）（rk）和（pk）的序列，如下所示：

系数a1=q1r1

设置a2=r1q1

系数a2=q2r2

设置a3=r2q2

…

系数ak=qkrk

设置AK+1=RKQK

…

因此，通过交换qk和

RK。定义pk的依据

pk=q1q2···qk。

由于ak=qkrk，我们得到了rk=q kak，并且由于ak+1=rkqk，我们得到了

.（1）

一个明显的归纳显示

，

那就是

ak+1=pk apk.（2）

因此，AK+1和A是相似的，所以它们具有相同的特征值。

基本的QR迭代方法包括计算矩阵的序列AK，在理想情况下，期望AK“收敛”到上三角矩阵，更精确地说，主对角线下的AK部分变为零，对角线条目收敛到特征值。a.

这种理想情况只有在相当特殊的情况下才能实现。首先，如果a是一元的（或在实际情况下是正交的），因为在q r分解中我们有r=i，我们得到a2=i q=q=a1，所以这个方法没有任何进展。另外，如果a是一个实矩阵，因为ak也是实的，如果a有复杂的特征值，那么主对角线下面的ak部分就不能归零。一般来说，当A的特征值不同且模相同时，该方法就会遇到麻烦。

序列的收敛性（ak）只有在一些相当严格的假设下才能知道。即使在这样的假设下，这也不是真正的趋同。事实上，可以证明主对角线下的ak部分为零，对角线条目收敛到a的特征值，但对角线上的ak部分可能不收敛。然而，为了求A的特征值，这并不重要。

以下收敛结果在Ciarlet[14]中得到证明（第6章，定理6.3.10和Serre[57]中）（第13章，定理13.2）。它在实践中很少适用，除了对称（或厄米特）正定矩阵，我们稍后将看到。

定理17.1。假设（复数）n×n矩阵a是可逆的、可对角化的，且其特征值λ1，…，λn具有不同的模，因此

|λ1>λ2>···>λn>0.

如果a=p∧p−1，其中∧=diag（λ1，…，λn），并且如果p−1具有Lu因式分解，那么AK的严格下三角部分收敛到零，AK的对角线收敛到∧。

证据。我们在Ciarlet[14]中复制了证明（第6章，定理6.3.10）。研究矩阵pk=q1q2···qk的渐近行为。为此，我们需要考虑权力AK。

第1步。设Rk=Rk···r2r1。我们声称

ak=（q1q2···qk）（rk···r2r1）=pkrk。（3）

我们采用归纳法。基本情况k=1无关紧要。对于感应步骤，从

（2），我们有

pkak+1=apk。由于AK+1=RKQK=QK+1RK+1，我们有

pk+1rk+1=pkqk+1rk+1rk=pk ak+1rk=apkrk=aak=ak+1

建立诱导步骤。

第2步。我们将矩阵pk表示为pk=q qek dk，用带单位项的对角矩阵dk表示，q和qek为一元。

设p=qr，p的qr因子分解（r为上三角矩阵，带正对角项），p−1=lu，p−1的lu因子分解。既然a=p∧p−1，我们有

ak=p∧kp−1=qr∧klu=qr（∧kl∧k）∧ku.（4）

这里，∧−k是条目为λ−i k的对角矩阵。引入矩阵∧kl∧−k的原因是其渐近行为易于确定。事实上，我们有

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.gif)

k−k）i j=1 k，如果i=j

（∧L∧号

假设λ1>λ2>····>λn>0意味着

lim∧kl∧−k=i.（†）k7→∞

注意，为了得到这个极限，我们假设了特征值的模。我们可以写信

∧kl∧−k=i+fk，其中lim fk=0，

K7→∞

因此，由于r（∧kl∧k）=r（i+fk）=r+rfkr−1r=（i+rfkr−1）r，我们得出

R（∧kl∧k）=（I+Rfkr−1）R.（5）

根据命题8.11（1），由于limk7→∞fk=0，因此limk7→∞rfkr−1=0，矩阵i+rfkr−1足够大是可逆的。因此，对于足够大的k，我们有一个qr因子分解，（6）

当（rek）i i>0时，i=1，…，n。因为矩阵qk是一元的，所以我们有=1，所以序列（qek）是有界的。因此，它有一个收敛子序列（qe`），它收敛到一个矩阵qe，这个矩阵qe也是一元的。自从

，

我们推导出子序列（re`）也收敛于某个矩阵re，该矩阵也是上三角形，具有正对角项。通过传递到极限（使用子序列），我们得到re=（qe），也就是说，

i=qer.e

通过qr分解的唯一性（当r的对角项为正时），我们得到

qe=re=i。

由于上述推理适用于（qek）和（rek）的任何子序列，根据极限的唯一性，我们得出结论，“全”序列（qek）和（rek）收敛：

lim qek=i，lim rek=i.k→∞7 k7→∞

从（4）开始，

ak=qr（∧kl∧k）∧ku，

通过（5）

R（∧kl∧k）=（I+Rfkr−1）R，

以及（6）

i+rfkr−1=qekrek，

我们证明了

ak=（qqek）（rekr∧ku）。（7）

观察到qqek是一个单位矩阵，rekr∧ku是一个上三角矩阵，作为上三角矩阵的乘积。然而，∧中的一些条目可能是负数，所以我们不能声称有正对角线条目。不过，我们还有另一个AK的QR分解，

ak=（qqek）（rekr∧ku）=pkrk.

很容易证明存在对角矩阵dk，其中i=1，…，n的（dk）ii=1，这样

pk=qqekdk.（8）

dk的存在是以下事实的结果：如果可逆矩阵b有两个qr因式分解b=q1r1=q2r2，那么就有一个对角矩阵d，其单位项为q2=dq1。

（8）中pk的表达式是我们正在寻找的表达式。

第3步。矩阵ak+1=pk apk的渐近行为。

由于a=p∧p−1=qr∧r−1q−1和by（8），pk=qqekdk，我们得到

.（9）


 

由于limk7→∞qk=i，我们推断

γ

α1

klim7→∞（qek）r∧r−1qek=r∧r−1=0…零

····λ2·····

……，

0···λn


 

在对角线上具有a特征值的上三角矩阵。由于R是上三角形，所以特征值的阶数保持不变。如果我们让

dk=（qek）r∧r−1qek，（10）

然后通过（9），我们得到了ak+1=dk dkdk，由于dk矩阵是对角矩阵，我们得到了

，

这意味着

（ak+1）i i=（dk）ii，i=1，…，n，（11）

由于（dk）i i=1，对于i=1，…，n.由于limk→∞7 dk=r∧r−1，我们得出的结论是，ak+1的严格下三角部分收敛到零，而ak+1的对角线收敛到∧。

如果矩阵A是实的，那么特征值具有不同模的假设意味着特征值都是实的和简单的。

下面的matlab程序使用第11.8节中的函数qrv4实现基本的qr方法。

函数t=qreigen（a，m）

t=a；对于k=1:m

[q r]=qrv4（t）；

t=r*q；

结束

例17.1。如果我们在8×8对称上运行100次迭代的函数qreigen

| 网络错误 |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
|          | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |

我们找到矩阵

.

对角线条目与运行matlab函数eig（a）得到的特征值相匹配。

如果几个特征值具有相同的模，那么证明就失效了，我们不能再声称（†），即

lim∧kl∧−k=i.k→∞7

如果我们假设P−1有一个合适的“块Lu因子分解”，可以证明矩阵AK+1收敛到块上三角矩阵，其中每个块对应具有相同模的特征值。例如，如果a是一个特征值为λi的9×9矩阵，使得 =124\ \\124;λ1 \\124;  \124\ \ λi的特征值为λi的9×9矩阵为\\ \\\\\\\\\\\124; \块）

| 网络错误 |                                                              |                                                              |                                                              |                                                              |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
|          | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |

更多详细信息，请参见CIARLET[14]（第6章第6.3节）。

在定理17.1的条件下，特别是，如果a是对称（或厄米特）正定矩阵，则a的特征向量可以近似。然而，当a不是对称矩阵时，由于ak的上三角部分不一定收敛，因此必须注意缺乏严格的理由。

假设我们将QR算法应用于满足定理17.1假设的矩阵A。当k足够大时，ak+1=pk apk几乎是上三角形，而ak+1的对角项都是不同的，因此我们可以认为它们是ak+1的特征值，因此是a的特征值。为了避免下标过多，请为通过设置pa的项得到的上三角形矩阵写t。在对角线到0的下方是ak+1的rt。然后通过求解线性系统，求出相应的特征向量。

tv=tiiv，

因为T是上三角形，所以这可以通过自下而上的消除来实现。我们把它作为一个练习来证明以下向量）是特征向量：

v1=e1，

如果i=2，…，n，那么

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.gif)

.


 

然后向量（pkv1，…，pkvn）是a的特征向量（近似）的基础，在t是对角矩阵的特殊情况下，i=1，…，n的vi=ei和pk的列是a的特征向量（近似）的正交基。

如果a是一个实矩阵，其特征值不都是实的，则存在一对复杂的特征值λ+i礹（具有礹=0）6，qr算法不能收敛到严格下三角部分为零的矩阵。有一种方法可以使用上赫森堡矩阵来处理这种情况，这将在下一节中讨论。

由于qr方法的收敛性主要取决于一个事实，即对角线下的ak部分变为零，因此，如果我们可以用一个类似的矩阵u au替换a，则很有必要从严格位于对角线下的具有大量零的矩阵u au进行计算。我们不能期望u au是一个对角矩阵（因为这意味着a很容易对角化），但事实证明有一种方法可以构造一个几乎是三角形的矩阵h=u au，除了它在主对角线下面可能有一个额外的非零对角线。下一节将讨论这种称为Hessenberg矩阵的矩阵。

## 17.2 Hessenberg矩阵

定义17.1.n×n矩阵（实数或复数）h是（上）Hessenberg矩阵，如果它几乎是三角形的，除了在主对角线下面可能有一个额外的非零对角线。从技术上讲，所有（j，k）的hjk=0，因此j−k≥2。

下面的5×5矩阵是Hessenberg矩阵的一个例子。

 ∗                                                         ∗         ∗       ∗     ∗

H21

H=0 H32。

                                                          

0 0 h43__

0 0 0 h54_

可以显示以下结果。

定理17.2。每一个n×n复数或实数矩阵a都类似于上赫森堡矩阵h，也就是说，对于某些单位矩阵u，a=uhu。此外，h可以被构造为户主矩阵的乘积（定义与第12.1节中的定义相同，只是w是一个复数向量，并且innER产品是中国大陆的赫敏内产品。如果a是实矩阵，那么h是正交矩阵（h是实矩阵）。

定理17.2和将矩阵转换为Hessenberg形式的算法在Trefethen和Bau[68]中讨论（第26讲）、Demmel[16]（第4.4.6节，在实际情况下）、Serre[57]（定理13.1）和Meyer[48]（在实际情况下，示例5.7.4）。正确性的证明并不难，而且将成为家庭作业问题的对象。

以下用matlab编写的函数实现了一个计算矩阵Hessenberg形式的函数。

函数屋构造标准化向量u，定义了户主反射，它将向量x中除第一个条目之外的所有条目归零。

函数[u u，u]=house（x）tol=2*10^（-15）；%公差uu=x；p=size（x，1）；

%计算x的l^1-范数（2:p，1）n1=和（abs（x（2:p，1））；如果n1<=tol

u=零（p，1）；uu=u；

其他的

l=sqrt（x'*x）；%l^2 x u u（1）=x（1）+signe（x（1））*l；u=uu/sqrt（uu'*uu）；结束

如果z<0，则函数signe（z）返回−1，否则返回+1。

buildhouse函数从向量UU构建一个户主反射。

功能P=建筑房屋（V，I）

%这个功能建立了一个户主的反映

%[I 0]%[0页]

%从户主的反映

%pp=i-2uu*uu'

%式中uu=v（i:n）

%如果uu=0，则p-i

%

n=尺寸（v，1）；如果v（i:n）=0（n-i+1,1）

P=眼睛（N）；其他

pp=眼睛（n-i+1）-2*v（i:n）*v（i:n）'；

P=[眼（i-1）零（i-1，n-i+1）；零（n-i+1，i-1）p p]；

结束

函数Hessenberg1计算一个上Hessenberg矩阵h和一个正交矩阵q，使a=q>hq。

函数[h，q]=Hessenberg1（a）

%

%此函数构造上Hessenberg

%矩阵H和正交矩阵Q

%A=Q’H Q

n=尺寸（a，1）；

H＝a；

Q=眼睛（n）；对于i=1:n-2

%h（i+1:n，i）

[~，u]=房屋（h（i+1:n，i））；

%u

P    =建筑用房（U，1）；

q（i+1:n，i:n）=p*q（i+1:n，i:n）；

h（i+1:n，i:n）=h（i+1:n，i:n）-2*u*（u’）*h（i+1:n，i:n）；

H（1:N，I+1:N）=H（1:N，I+1:N）-2*H（1:N，I+1:N）*U*（U’）；端部

例17.2。如果

，

运行Hessenberg1我们发现

| 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 |
| ---------------------------------------------------- | ----------------------------------------- | ----------------------------------------- | ---------------------------------------------------- |
|                                                      |                                           |                                           |                                                      |

Q   =00−00.8339.3714−00.1516.5571−00..74285307。

γ

0 0.4082−0.8165 0.4082

Hessenberg矩阵（上）的一个重要性质是，如果某个次极性项hp+1p=0，则h的形式为

，

其中h11和h22都是上Hessenberg矩阵（具有h11 a p×p矩阵和h22 a（n-p）×n-p矩阵），h的特征值是h11和h22的特征值。例如，在矩阵中

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | ---------------------------------------------------- | ----------------------------------------- | ----------------------------------------- | ----------------------------------------- |
| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误            | 网络错误   网络错误   网络错误   网络错误 |

h的特征值列表是h11的特征值列表和h22的特征值列表的串联。通过对H11块尺寸的归纳，很容易看出这一点。

更一般地说，每一个上海森堡矩阵都可以用这样的方式来写：它有对角块，这是海森堡块，其次对角块不是零。

定义17.2.如果i=1，…，n−1的hi+1i=06，则上Hessenberg n×n矩阵h是未减少的。一个没有被约化的海森堡矩阵被称为约化矩阵。

以下是一个8×8矩阵的示例，该矩阵由三个对角未缩减的Hessenberg块组成：

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
|                                                              |                                                              |                                                              |                                                              |                                                              |                                           |                                                              |                                                              |

下面是一个有趣的和重要的性质的未减少的海森堡矩阵。

提案17.3.设h为n×n复形或实无约Hessenberg矩阵。那么h的每个特征值在几何上都是简单的，即对于每个特征值λ，dim（eλ）=1，其中eλ是与λ相关的特征空间。此外，如果h是对角化的，那么每个特征值都是简单的，即h有n个不同的特征值。

证据。我们遵循Serre的证据[57]（提案3.26）。设λ为h的任何特征值，设

m=λin−h，n是从m中删除第一行和最后一列得到的（1）矩阵。由于是上赫森堡，n是一个对角线矩阵，条目−hi+1i=06，i=1，…，n−1。因此，n是可逆的，具有n-1的秩。但矩阵的秩大于或等于其任何子矩阵的秩，因此秩（m）=n-1，因为m是奇异的。根据秩零定理，秩（kern）=1，即dim（eλ）=1，如权利要求所述。

如果h是对角化的，那么特征空间的维数之和等于n，这意味着h的特征值是不同的。

如前所述，定理17.1适用的情况是，a是对称（或厄米特）正定矩阵的情况。这源于两个事实。

第一个事实是，如果a是厄米特矩阵（或在实际情况下是对称的），那么很容易证明类似a的Hessenberg矩阵是厄米特矩阵（或在实际情况下是对称的）三对角矩阵。转换方法也更有效。下面是一个由三个未减少的块组成的对称三对角矩阵的示例：

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
|                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |

因此，求对称（或厄米特）矩阵的特征值的问题可归结为求对称（或厄米特）矩阵的特征值的问题。赫密特）三对角矩阵，这可以更有效地完成。

第二个事实是，如果h是一个上海森堡矩阵，如果它是可对角化的，那么就有一个可逆矩阵p，使得h=p∧p−1带有∧一个由h的特征值组成的对角矩阵，这样p−1就有一个lu分解；见serre[57]（定理

13.3）。

因此，由于任何对称（或厄米提亚）三对角矩阵都是非降阶对称（resp）的块对角矩阵。Hermitian）三对角矩阵，通过17.3，我们看到应用于对称（或Hermitian）正定的三对角矩阵的QR算法收敛到由其特征值组成的对角矩阵。让我们记录下这一重要事实。

定理17.4。设h为对称（或厄米特）正定三对角矩阵。如果h不被约化，则qr算法收敛到由h的特征值组成的对角矩阵。

因为每一个对称（或厄米特）正定矩阵都与三对角对称（resp）相似。厄米特）正定矩阵，我们推导出一种求对称（resp）特征值的方法。正定矩阵（更准确地说，为了找到这些特征值的近似值）。

如果a是对称（或厄米特）矩阵，由于其特征值是实的，对于一些足够大的μ>0（pickμ>ρ（a）），a+μi是对称的（resp.Hermitan）正定的，因此我们可以将qr算法应用到一个类似于a+μi的上Hessenberg矩阵中，找到它的特征值，然后通过减去μ得到a的特征值。

关于对称矩阵特征值的求法问题，帕莱特[50]中有大量论述，这是本课题的最佳参考文献之一。

上海森堡形式也产生了一种处理奇异矩阵的方法。首先，检查命题13.21的证明，一个n×n的复数矩阵a（可能是奇异的）可以被分解为a=q r，其中q是户主反射的乘积，r是上三角形，很容易看出，如果a是上Hessenberg，那么q也是上Hes森伯格。如果h是一个未减少的上海森堡矩阵，因为q是上海森堡矩阵，并且

R是上三角形，当i=1…，n-1时，我们有hi+1i=qi+1i rii，由于h不被减少，当i=1，…，n-1时，rii=06。因此，h是单数iff rnn=0。那么矩阵rq是最后一行由零组成的矩阵，因此我们可以通过考虑删除最后一行和最后一列得到的（n-1）×（n-1）未减少的Hessenberg矩阵来消除问题。在有限多个步骤之后（不大于特征值0的多重性），仍然存在一个可逆的不可约Hessenberg矩阵。作为替代方案，见SERRE[57]（第13章，第13.3.2节）。

事实上，QR算法虽然很简单，但由于几个原因效率很低。在下一节中，我们将说明如何提高方法的效率。这涉及到很多工作，我们只在高层讨论主要想法。

## 17.3提高使用轮班的QR方法的效率

为了提高效率，并应对实矩阵中的复共轭特征值对，采取以下步骤：

(1)    最初将矩阵A简化为上赫森堡形式，即A=uhu。然后将qr算法应用于h（实际上，应用于其未减少的hessenberg块）。很容易看出，由QR算法生成的矩阵hk仍保持在Hessenberg的上方。

(2)    为了加速收敛，使用移位，为了处理复共轭特征值对，使用双移位。

(3)    在进行移位时，不需要显式计算qr因子分解，而是执行隐式移位，该移位不需要计算qr factorization（ak-σki），同样，在进行双移位时也需要计算qrfactorization。这是对基本QR算法最复杂的修改，我们在这里不讨论它。这种方法通常被称为鼓包追逐。有关实数矩阵的这种技术的详细信息，请参见demmel[16]（第4.4.8节）和Golub和van Loan[30]（第7.5节）。Watkins在复杂矩阵的更一般情况下讨论了移位作为凸点追踪方法的QR算法[73，74]。


 

17.3。使用移位使QR方法更有效

让我们重复上一节中的一个重要评论。如果我们以Hessenberg上形式的矩阵h开始，如果在qr算法的任何阶段，我们发现某些次方向项（hk）p+1p=0或非常小，那么hk就是这种形式。

，

| 网络错误                                                     |                                                      |                                           |                                           |                                           |
| ------------------------------------------------------------ | ---------------------------------------------------- | ----------------------------------------- | ----------------------------------------- | ----------------------------------------- |
| 网络错误                                                     |                                                      |                                           |                                           |                                           |
| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 |
| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误            | 网络错误   网络错误   网络错误   网络错误 |

其中h11和h22都是上Hessenberg矩阵（h11 a p×p矩阵和h22

然后我们可以递归地将qr算法应用到h11和h22。

特别是，如果（hk）nn−1=0或非常小，那么（hk）nn是特征值的良好近似值，因此我们可以删除hk的最后一行和最后一列，并将qr算法应用于该子矩阵。这个过程叫做通货紧缩。如果（hk）n−1n−2=0或非常小，则2×2“角块”

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.gif)

出现了，它的特征值可以通过解二次方程立即计算出来。然后，我们通过删除最后两行和最后两列来缩小hk，并将qr算法应用于该子矩阵。

因此，似乎需要修改基本的QR算法，以便出现上述情况，这就是移位的设计目的。更准确地说，在定理17.1的假设下，可以证明（见第6.3节，Ciarlet[14]）具有i>j的入口（ak）ij收敛到0，因为λi/λj_k收敛到0。另外，如果我们让ri定义为

，

然后有一个常数c（独立于k），这样

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.gif)

特别是，如果h是上Hessenberg，则条目（h k）i+1i收敛到0，因为λi+1/λi_k收敛到0。因此，如果我们选取靠近λi的σk，我们期望（hk−σki）i+1i收敛到0，因为（λi+1−σk）/（λi−σk）k收敛到0，并且这个比率比1小得多，因为σk更接近λi。通常，我们应用移位来加速收敛到λn（因此i=n-1）。在这种情况下，（hk−σki）nn-1和（hk−σki）nn−λn收敛到0，因为（λn−σk）/（λn−1−σk）k收敛到0。

移位是以下修改的QR步骤（切换回任意矩阵A，因为移位技术通常适用）。选择一些σk，希望接近a的特征值（一般来说，λn），以及qr因子ak-σki作为

AK−σki=qkrk，

然后形成

AK+1=RKQK+σki。

自从

AK+1=RKQK+σki

=q kqkrkqk+q k q kσk

=q k（qkrk+σki）qk

=Q Kakqk，

AK+1与AK类似，如前所述。如果ak是上海森堡，那么很容易看出ak+1也是上海森堡。

如果a是上Hessenberg，如果σi正好等于特征值，那么ak-σki是奇异的，形成qr因式分解将检测到Rk有一些等于0的对角线入口。假设qr算法返回（rk）nn=0（如果不是，参数很容易适应），那么RKQK的最后一行是0，所以AK+1=RKQK+σki的最后一行以σk结尾（所有其他项都为零），所以我们可以对ak进行放气（而σk实际上是一个特征值）。

问题是，对于移位σk，什么是一个好的选择？

再次假设h为上赫森堡形式，结果表明当（h k）nn-1足够小时，σk的一个好选择是（h k）nn。事实上，收敛速度是二次的，这意味着在每次迭代中，正确数字的数目大致都会加倍。原因是移位与另一种称为逆迭代的方法有关，这种方法收敛得很快。关于这种联系的进一步解释，见demmel[16]（第4.4.4节）和trefethen和bau[68]（第29课）。

我们仍然应该谨慎，带移位的qr方法不一定收敛，并且我们的收敛证明不再适用，因为我们没有拥有标识ak=pkrk，而是

（a−σki）···（a−σ2i）（a−σ1i）=pkrk。

17.3。使用移位使QR方法更有效

当然，当应用于正交矩阵A时，QR算法会立即循环，当A是对称的但不是正定的时候也是如此。例如，QR算法和矩阵上带移位环的QR算法

.

在对称矩阵的情况下，威尔金森发明了一种移位，这有助于QR算法的移位取得进展。再看看AK的下角，说

，

威尔金森位移选取的特征值B更接近A。如果我们让

δ=an−1−an，

二

很容易看出，b的特征值由

.

接下来是

从这个很容易看出，更接近a的特征值是由

.

如果δ=0，那么我们可以任意选取两个特征值中的一个。观察应用于矩阵的威尔金森位移

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image010.gif)

是+1或−1，在一个步骤中，会发生通缩，算法成功终止。

我们现在讨论双移位，这是为了处理复共轭特征值对。

假设A是一个实矩阵。对于具有非零虚数部分的复数σk，双移位包括以下步骤：

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image012.gif)

根据对单个位移的计算，我们得到了ak+1=q kakqk和ak+2。=

q k+1ak+1qk+1，因此我们得出

.

矩阵qk是复杂的，所以我们希望ak也是复杂的，但很明显我们可以保持产品qkqk+1是真实的，所以ak也是真实的。这是非常理想的避免复杂的算术，这是更昂贵的。

从那以后再观察

qk+1rk+1=ak+1−σk i=rkqk+（σk−σk）i，

我们有

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image014.gif)

如果我们通过归纳假设矩阵ak是实的（k=2`+1，`≥0），那么矩阵s=a2k−2（<σk）ak+σk 2i也是实的，因为qkqk+1是一元的，而rk+1rk是上三角的，我们可以看到

S=QKQK+1RK+1RK

是实矩阵s的qr因子分解，因此qkqk+1和rk+1rk可以选择为实矩阵，在这种情况下（qkqk+1）也是实矩阵，因此

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image016.gif)

是真的。因此，如果a1=a是实的，那么a2`+1对所有的`≥0都是实的。

选择σk和σk作为角块复共轭特征值的策略

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image018.gif)

被称为弗朗西斯位移（这里我们假设a已经被简化为上海森堡形式）。

应该注意的是，有些矩阵的（hk）nn移位和Francis移位都不起作用。例如，置换矩阵

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image020.gif)

具有特征值ei2π/3，ei4π/3，+1，并且上述两种移位都不适用于矩阵

.

17.4。Krylov子空间；Arnoldi迭代

但是，按1的移位确实有效。还有其他类型的矩阵，QR算法不收敛。demmel给出了形式矩阵的例子。

0 1 0 0_

10小时0_

0−H 0 1

0 0 1 0

其中h是小的。

采用移位和双移位的QR算法每10个移位执行一次“异常”移位。尽管自20世纪60年代以来QR算法得到了完善，但寻找一种确保所有矩阵收敛的移位策略仍然是一个开放性问题。

隐式移位是基于一个被称为隐式Q定理的结果。这个定理表明，如果a被简化为a=u h u的上海森堡形式，而h未被简化（i=1，…，n−1，hi+1i=06），那么索引2，…，n的u列由u的第一列直到符号决定；见demmel[16]（定理4.9）和golub和van loan[30]（定理7.4.2）。对于实矩阵的证明。事实上，证明并不难，而且将是家庭作业练习的对象。在单个移位的情况下，隐式移位生成ak+1=q kakqk，而无需计算ak-σki的qr因子分解。对于实矩阵，这是通过应用一系列执行凸起追踪过程的givens旋转来完成的（givens旋转是一个正交的块对角矩阵，由一个二维旋转的单个块组成，其他对角线条目等于1）。同样，在双移位的情况下，AK+2=（QKQK+1）AKQKQK+1生成时不需要计算AK−σki和AK+1−σki的QR因子分解。同样地，（qkqk+1）akqkqk+1是通过应用一些简单的正交矩阵来生成的，这些矩阵执行一个凸起追踪过程。参见demmel[16]（第4.4.8节）和Golub和van Loan[30]（第7.5节），了解关于真实矩阵中涉及凸起追踪的隐式移位的进一步解释。Watkins[73，74]讨论了复杂矩阵的更一般情况下的凸度追踪。

求矩阵A的特征值和特征向量的matlab函数是特征值，称为[u，d]=eig（a）。它是使用隐式移位的优化版QR算法实现的。

如果矩阵A的维数非常大，我们可以通过使用截断形式的约简来找到A的一些特征值的近似值，这种约简形式通常是由于阿诺迪和兰佐斯在对称（或厄米提亚）三对角情况下的约简。

## 17.4 Krylov子空间；Arnoldi迭代

在这一节中，我们用m而不是n来表示正方形实矩阵或复矩阵的维数，以便读者更容易理解Trefetten和Bau的论述[68]，这一点特别清晰。

| 网络错误 |                                                              |                                |                                |                                           |                                |
| -------- | ------------------------------------------------------------ | ------------------------------ | ------------------------------ | ----------------------------------------- | ------------------------------ |
|          | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误 |

假设m×m矩阵a已简化为上赫森堡形式h，即a=uhu。对于任何n≤m（通常小于m），考虑（n+1）×n

h，删除最后一行hen得到的n×n上Hessenberg矩阵hn，

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误 | 网络错误   网络错误 | 网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | -------- | ------------------- | ------------------------------ | ------------------------------ |
|                                                              |          |                     |                                |                                |

如果用u n表示由u的前n列组成的m×n矩阵，表示为u1，…，un，那么由矩阵的前n列组成的矩阵uh=au可以表示为

.（1）

因此，该矩阵的第n列可以表示为

aun=h1nu1+····+hnnun+hn+1nun+1。（2）

由于（u1，…，un）形成了正态基，我们从（2）推导出

（3）

方程（2）和（3）表明，由于Arnoldi（称为Arnoldi迭代），可以使用以下算法迭代计算un+1和hen：

给定任意非零向量b∈cm，设u1=b/kbk；对于n=1,2,3，…do z：=aun；对于j=1至n do hjn：=u jz；

Z：=Z−HJnuj

endfor hn+1n：=kzk；如果hn+1n=0退出

17.4。Krylov子空间；Arnoldi迭代un+1=z/hn+1n

当hn+1n=0时，我们说Arnoldi迭代有一个分解。

Arnoldi迭代是一种生成完整的Hessenberg矩阵h的n×n Hessenberg子矩阵hn的算法，该矩阵由其前n行和n列组成（U的前n列也是生成的），而不使用户主矩阵。

只要j=1，…，n的hj+1j=06，方程（2）通过一个简单的归纳表明，un+1属于（b，ab，…，anb）的跨度，而aun显然属于（u1，…，un+1）的跨度，因此以下空间是相同的：

span（b，ab，…，anb）=span（u1，…，un+1）。

空间kn（a，b）=span（b，ab，…，an−1b）称为krylov子空间。我们可以将Arnoldi算法看作是构造kn（a，b）的正交基。这是一种克-施密特程序。

方程（2）表明，如果kn是m×n矩阵，其列为向量（b，ab，…，an−1b），则存在n×n上三角矩阵rn，从而

kn=unrn.（4）

上面称为kn的简化qr因子分解。

因为（u1，…，un）是一个正交系统，矩阵是由单位矩阵加上一个0的额外列组成的+1）矩阵，所以

通过删除母鸡的最后一行，即hn获得，依此类推。

.（5）

我们将上述事实概括为以下命题。

提案17.5。如果Arnoldi迭代在m×m矩阵a上以非零向量b∈cm开始运行，在n≤m阶段没有崩溃，则以下属性保持不变：

*(1)*     如果kn是与向量（b，ab，…，a n−1b）相关联的m×n krylov矩阵，如果un是由Arnoldi迭代生成的正交向量的m×n矩阵，则存在qr因子分解。

kn=unrn，

对于一些n×n上三角矩阵rn。

*(2)*     Arnoldi迭代产生的m×n上Hessenberg矩阵hn是a对krylov空间kn（a，b）的投影，也就是说，

.

*(3)*     连续迭代与公式有关

aun=un+1小时。

注：如果Arnoldi迭代在n阶段有一个分解，即hn+1=0，那么我们就找到了Hessenberg矩阵h的第一个未简化块，可以证明hn的特征值是a的特征值，所以分解实际上是一件好事。在这种情况下，我们可以选择一些与向量（u1，…，un）正交的新的非零向量un+1作为新的起始向量，并再次运行arnoldi迭代。这种向量存在于u的第（n+1）列工作之后。因此，反复应用Arnoldi得到了a的完全Hessenberg约简，但这不是我们想要的，因为m非常大，我们只对a的“少量”特征值感兴趣。

Arnoldi迭代还有一个方面，它解决了一个涉及n次多项式的优化问题。让pn表示n次（复数）多项式的集合，即形式的多项式。

p（z）=zn+cn−1zn−1+····+c1z+c0（ci∈c）。

对于任何M×M矩阵A，我们写

p（a）=an+cn−1an−1+····+c1a+c0i。

以下结果在Trefethen和Bau[68]中得到了证明（第34课，定理34.1）。

定理17.6。如果以非零向量b开始的m×m矩阵a上运行的Arnoldi迭代在n≤m阶段没有崩溃，则存在一个唯一的多项式p∈pn，使得kp（a）bk2最小，即hn的特征多项式det（zi-hn）。

定理17.6可被视为一种求其某些特征值的方法的“正当理由”。直观地说，hn特征多项式的根越接近a的特征值，kp（a）bk2越小，反之亦然。在m=n的极端情况下，根据凯莱-汉密尔顿定理，p（a）=0（其中p是a的特征多项式），所以这个想法是合理的，但这远不能构成一个证明（同时，b在与特征值相关的所有方向上都应该有非零坐标）。

称为瑞利-里兹方法的方法是在a和一些b=06上运行阿诺迪迭代，随机选择步骤，直到出现故障。然后在hn上运行移位的qr算法。然后，可以将Hessenberg矩阵hn的特征值视为a特征值的近似值。hn的特征值称为Arnoldi估计或Ritz值。我们必须谨慎，因为hn是完整的Hessenberg矩阵h的截尾形式，所以并非所有的Ritz值都必须接近a的特征值。据观察，首先找到的特征值是a的极端特征值，即那些接近a的边界的特征值。图中A的谱，如果A有实特征值，最大和最小的特征值首先作为Ritz值出现。在许多特征值出现的问题中，极值特征值是需要计算的。同样，可以将hn的特征向量视为a的特征向量的近似值。

17.5。GMRES

Matlab函数的特征值是基于Ritz值的计算。它计算矩阵A的最大数量的六个特征值，调用为[v，d]=eigs（a）。更一般地说，要得到顶部的k特征值，使用[v，d]=特征值（a，k）。

在缺乏关于误差估计的严格定理的情况下，很难使上述陈述更加精确；关于这一主题的更多信息，请参见Trefethen和Bau[68]（第34课）。

但是，如果a是对称（或厄米特）矩阵，那么hn是对称（resp）。Hermitian）三对角矩阵和更精确的结果可以显示出来；见demmel[16]（第7章，特别是第7.2节）。我们将在下一节中考虑对称（和厄米坦）情况，但首先我们将展示如何使用Arnoldi迭代来寻找线性系统ax=b的近似解，其中a是可逆的，但m的尺寸非常大。

## 17.5克重

假设A是可逆M×M矩阵，B是非零向量，单位为厘米。设X0=a−1b，ax=b的唯一解，不难证明X0∈kn（a，b）对于一些n≤m，实际上存在一个极小阶s≤m的唯一Monic多项式p（z），使得p（a）b=0，所以X0∈ks（a，b）。因此，在维数m≤s的krylov空间中寻找ax=b的解是有意义的，其思想是求X0的近似值xn∈kn（a，b），使rn=b−axn最小化，即krnk2=kb−axnk2在xn∈kn（a，b）上最小化。

这个最小化问题可以表述为

最小化krnk2=kaxn−bk2，xn∈kn（a，b）。

这是一个最小二乘问题，我们知道如何解决它（见第21.1节）。量Rn被称为残差，对于广义最小残差，包含最小化krnk2的方法被称为gmres。

现在，因为（u1，…，un）是kn（a，b）的基础（因为n≤s，除了n=s，没有发生故障），我们可以写xn=uny，所以我们的最小化问题是

最小化kauny−bk2，y∈cn。

由于第17.4节（1），我们得出aumn=un+1hen，最小化kauny−bk2等于最小化c上的kun+1heny−bk2。由于un+1heny和b属于un+1的列空间，因此最小化kun+1heny−bk2等于最小化。

但是，通过施工，

，

所以我们的最小化问题可以表述为

最小化。

ax=b的近似解是

xn=uny。

从u1=b/kbk2，n=1开始，GMRES方法进行n≤s阿诺尔底迭代，找到un和hen，然后运行一种求解最小二乘问题的方法。

最小化kheny−kbk2e1k2，y∈cn。

当krnk2=kheny−kbk2e1k2足够小时，我们停止，ax=b的近似解为xn=uny。

我们刚刚介绍的GMRES“幼稚”版本有一些提高效率的方法；见Trefethen和Bau[68]（第35课）。我们现在考虑的情况是，a是一个厄米特（或对称）矩阵。

## 17.6 Hermitian案例；Lanczos迭代

如果a是m×m对称矩阵或厄米特矩阵，那么阿诺迪方法简单而有效。事实上，在这种情况下，很容易看出上海森堡矩阵hn也是对称的（分别是赫米特矩阵），因此是三对角矩阵。另外，特征值

a和hn是真的。写起来很方便

α1β1_

β1α2β2_

…。

hn=β2α3

                                                        

……βn−1βn−1αn

第17.4节的复发（2）成为三期复发。

aun=βn−1un−1+αnun+βnun+1。（6）

我们也有，所以Arnoldi的算法变成了下面的算法，叫做Lanczos算法（或Lanczos迭代）。J上从1到n的内环已被消除，并被一个单独的赋值所取代。

给定任意非零向量b∈cm，设u1=b/kbk；对于n=1,2,3，…做

Z：=aun；

；

Z：=Z−βn−1un−1−αnun

βn：=kzk；如果βn=0退出un+1=z/βn

17.7。功率法

当βn=0时，我们说我们有兰佐斯迭代的分解。

命题17.5和定理17.6的版本适用于Lanczos迭代。

Lanczos迭代除了比Arnoldi迭代更有效外，还有一个优点，那就是瑞利-瑞兹方法用于寻找a的一些特征值，作为对称（分别是Hermitian）三对角矩阵hn的特征值，但是有更多的方法可以找到t。对称（分别是厄米特矩阵）三对角矩阵的特征值。还存在关于误差估计的定理。上面给出的Lanczos迭代版本可能在浮点运算中遇到问题。结果是，矢量UJ可能失去正交性，因此有必要对其进行重定位。有关更多信息，请参见demmel[16]（第7章，特别是第7.2-7.4节）。使用lanczos迭代的gmres版本称为minres。

我们结束了对计算矩阵特征值和特征向量的方法的简短调查，并对两种称为幂次法的方法进行了快速讨论。

## 17.7动力方法

设A为m×m复矩阵或实矩阵。有两种功率方法，都会产生一个特征值和一个与此向量相关的特征向量：

(1)    动力迭代。

(2)    逆（幂）迭代。

只有当矩阵A具有最大模的特征值λ时，方可进行幂次迭代，也就是说，如果λ1，…，λm是a的特征值，那么

|λ1>λ2≥······≥λm≥0.

特别是，如果a是一个实矩阵，那么λ1必须是实矩阵（否则有两个相同最大模的复共轭特征值）。如果满足上述条件，则功率迭代得到λ1及其相关的一些特征向量。方法非常简单：

选取一些初始单位向量X0并计算以下序列（XK），其中

.

我们期望（xk）收敛到与λ1相关的特征向量，但这并不完全正确。以下结果在SERRE[57]中得到证实（第13.5.1节）。首先假设λ1=0.6

我们有

.

如果A是一个具有最大模的唯一复特征值λ1的复矩阵，那么

γ

是与λ1相关联的a的单位特征向量。如果λ1为真，则

V=lim xk k7→∞

是与λ1相关联的a的单位特征向量。实际上，在X0上需要一些条件：X0必须在与λ1相关的特征空间e中有一个非零分量（在任何直接和cm中，e是和）。

特征值λ1如下所示。如果λ1是复数，并且vj=06是v的任何非零坐标，那么

.

如果λ1是实的，那么我们可以通过以下方式定义序列（λ（k））：

λ（k+1）=（xk+1）axk+1，k≥0，

我们有

λ1=limλ（k）。K7→∞

实际上，在这种情况下，由于v=limk7→∞xk和v是λ1的单位特征向量，我们得到

limλ（k）=lim（xk+1）axk+1=v av=λ1v v=λ1.K7→∞K7→∞

注意，由于xk+1是单位向量，（xk+1）axk+1是瑞利比。

如果a是一个厄米矩阵，那么特征值是真实的，我们可以说更多的收敛速度，这不是很大（只有线性）。有关详细信息，请参阅Trefetten和Bau[68]（第27课）。

如果λ1=0，则存在一些功率`<m，使得ax`=0。

反迭代法的目的是找到一个特征向量与一个我们知道一个很好的近似值μ的特征值λ相关。

选取一些初始单位向量X0，计算以下序列（wk）和（xk），其中wk+1是系统的解

（a−μi）wk+1=xk等于wk+1=（a−μi）−1xk，k≥0，

和

.

以下结果在Ciarlet[14]中得到证明（定理6.4.1）。

17.8。总结

提案17.7。设a为特征值为λ1，…，λm的m×m可对角化（复或实）矩阵，并设λ=λ`为a的任意特征值（不必简单）。

对于任何这样的

μ=6λ和μ−λ<μ−λj对于所有j=6`，

如果X0不属于特征值λj（j=6`）相关特征向量所跨越的子空间，则

\-

其中v是与λ相关的特征向量。此外，如果λ和μ都是真的，我们有

| 网络错误   网络错误 | 网络错误   网络错误 |
| ------------------- | ------------------- |
|                     |                     |

K7→∞

另外，如果我们用

λ（k+1）=（xk+1）axk+1，

然后

limλ（k+1）=λ。

K7→∞

X0的条件可能看起来相当严格，但在实践中，随机选择的向量X0通常满足它。

如果A是一个厄米矩阵，那么我们可以说更多。特别是，可以修改逆迭代算法，以利用新计算的λ（k+1）而不是μ，从而实现更快的收敛。这种方法叫做瑞利商迭代。当它收敛时（几乎是所有的X0），这种方法最终达到了三次收敛，这是显著的。从本质上来说，这意味着在每次迭代中正确数字的数量是三倍。更多详情，见Trefetten和Bau[68]（第27课）和Demmel[16]（第5.3.2节）。

## 17.8总结

本章的主要概念和结果如下：

•     二维码迭代，二维码算法。

•     上海森堡矩阵。

•     户主矩阵。

•     未简化和约化的Hessenberg矩阵。

•     通货紧缩。

•     换档。

•     威尔金森轮班。

•     双班制。

•     弗朗西斯变换。

•     隐性转变。

•     隐式Q定理。

•     阿诺迪迭代。

•     阿诺迪迭代的分解。

•     Krylov子空间。

•     瑞利-里兹法。

•     里兹值，阿诺迪估计。

•     剩余。

•     GMRES

•     Lanczos迭代。

•     动力迭代。

•     逆功率迭代。

•     瑞利比。

## 17.9问题

问题17.1。证明定理17.2；见问题12.7。

问题17.2。证明了如果矩阵A是厄米特矩阵（或实对称），那么任何与A相似的海森堡矩阵H都是厄米特三对角矩阵（实对称三对角）。

问题17.3。对于任何矩阵（实矩阵或复矩阵）a，如果a=qr是使用户主反射的qr分解，证明如果a是上赫斯伯格，那么q也是。

问题17.4。证明如果a是上海森堡，那么应用qr算法得到的矩阵ak也是上海森堡。

17.9。问题

问题17.5。证明隐式Q定理。这个定理表明，如果a被简化为上赫森伯格形式a=u h u，如果h不被简化（i=1，…，n−1时hi+1i=06），那么索引2，…，n的列由u的第一列到符号决定；

问题17.6。阅读Golub和van Loan[30]的第7.5节，并使用轮班实现他们的QR算法版本。

问题17.7。如果阿诺迪迭代在n阶段有一个分解，即hn+1=0，那么我们就找到了Hessenberg矩阵h的第一个不可约块，证明hn的特征值是a的特征值。

问题17.8。证明定理17.6。

问题17.9。实现GRMES并在一些线性系统上进行测试。

问题17.10。陈述并证明关于Lanczos迭代的17.5号命题和17.6号定理的版本。

问题17.11。证明第17.7节所述的功率迭代法的结果。

问题17.12。证明17.7节所述逆功率迭代法的结果。

问题17.13。实现并测试了功率迭代法和逆功率迭代法。

问题17.14。阅读Trefethen和Bau[68]中的第27讲，实现并测试瑞利商迭代法。