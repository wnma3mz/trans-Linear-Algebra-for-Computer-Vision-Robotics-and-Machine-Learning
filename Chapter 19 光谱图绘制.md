第十九章

# 光谱图绘制

## 19.1图形绘制和能量最小化

设g=（v，e）为无向图。通常需要绘制一个图形，通常是在平面上，但可能是在三维中，结果证明，拉普拉斯图可以用来设计出奇的好方法。假设v=m，其思想是将RN中的点ρ（vi）赋给顶点vi∈v，对于每个vi∈v，并在点ρ（vi）和ρ（vj）之间画一条直线段，如果有边vi，vj。

定义19.1.设g=（v，e）为具有m个顶点的无向图。图形绘制是函数ρ：v→rn，对于某些n≥1。图的矩阵ρ（in r n）是m×n矩阵r，其中第i行由表示r中vi的点对应的行向量ρ（vi）组成。

为了使图形绘图有用，我们希望n≤m；实际上n应该比m小得多，通常n=2或n=3。

定义19.2.图的绘制是平衡的，如果图的矩阵的每一列的条目之和为零，也就是说，

1>r=0。

如果图的绘制不平衡，可以通过适当的翻译使其平衡。我们也可以假设r的列是线性独立的，因为列空间的任何基础也决定了绘图。因此，从现在开始，我们可以假定n≤m。

注：图的ρ：v→rn不需要求内射，这可能导致退化图，其中不同的顶点绘制为同一点。因此，我们不喜欢使用文献中经常使用的术语图嵌入。这是因为在微分几何中，嵌入总是指一个内射映射。术语图浸入更合适。

六百三十一

如Godsil和Royle[28]所述，我们可以想象通过相同弹簧连接相邻顶点（RN）来建立G的物理模型。那么，如果要求弹簧的延伸度较小，那么考虑更好的表示是很自然的。我们可以通过定义绘图r的能量

，

其中，ρ（vi）是r的第i行，kρ（vi）−ρ（vj）k2是连接ρ（vi）和ρ（vj）的线段欧几里得长度的平方。

那么，“好的图”就是把能量函数e最小化的图，当然，对应于零矩阵的平凡表示是最优的，所以我们需要施加额外的约束来排除平凡解。

我们可以考虑弹簧不一定相同的更一般的情况。这可以通过对称重量（或刚度）矩阵w=（wij）来建模，wij≥0。然后我们的能量函数变成

.

结果表明，该函数可以用拉普拉斯L=d−w表示。以下命题在Godsil和Royle[28]中给出。我们提供了一个更直接的证据。

提案19.1。设g=（v，w）为加权图，其中v=m n，w为m×m对称矩阵，r为g在r（m×n矩阵）中的图形ρ的矩阵。

如果l=d−w是与w相关的非正规拉普拉斯矩阵，那么

e（r）=tr（r>lr）。

证据。因为ρ（vi）是r的第i行（而ρ（vj）是r的第j行），如果我们用Rk表示r的第k列，用18.4号命题，我们得到

，

如要求。


 

19.1。图形绘制与能量最小化

由于矩阵r>lr是对称的，所以它具有实特征值。实际上，因为l是正半定的，所以r>lr也是。那么r>lr的迹线等于它的正特征值之和，这就是图的能量e（r）。

如果r是RN图的矩阵，那么对于任意n×n可逆矩阵m，将ρ（vi）m赋给vi的映射是g的另一个图，这两个图传递的信息量相同。从这个角度来看，图的绘制是由R的列空间决定的，因此，可以合理地假设R的列是成对正交的，并且它们有单位长度。这样的矩阵满足方程

r>r=i。

定义19.3.如果图的矩阵r满足方程r>r=i，则相应的图称为正交图。

上述条件也排除了一些琐碎的绘图。下面的结果告诉我们如何找到最小能量正交平衡图，只要图是连接的。回想一下

l1=0，

正如我们已经观察到的。

定理19.2。设g=（v，w）为v=m的加权图。如果l=d−w是g的（未归一化）拉普拉斯函数，如果l的特征值为0=λ1<λ2≤λ3≤…≤λm，则Rn中g的任意平衡正交图的最小能量等于λ2+·····+λn+1（特别是这意味着n<m）。由任意单位特征向量u2，…，un+1组成的m×n矩阵r与λ2≤…≤λn+1得到最小能量的平衡正交图，满足r>r=i的条件。

证据。我们给出了Godsil和Royle[28]给出的证明（第13.4节，定理13.4.1）。关键是L的n个最小特征值之和是tr（r>lr）的下界。这可以用瑞利比论证来证明；见命题16.25（Poincar'e分离定理）。然后，任何与λ1，…，λn相关的n个特征向量（u1，…，un）都达到这个界限。因为l的第一个特征值是λ1=0，并且因为我们假设λ2>0，所以我们得到了u1=1/√m。由于uj对i=2是正交的，…，n并且因为ui对u1=1/√m是正交的，所以ui中的项加起来是0。因此，对于2≤`≤n的任意‘图，通过删除u1并使用（u2，…，u`），我们得到了r`-1中与r`使用（u1，u2，…，u`）中正交图绘制能量相同的平衡正交图。相反，利用（u2，…，u`）在r`-1中绘制平衡正交图，我们得到了能量相同的r``中使用（u1，u2，…，u`）绘制的正交图。因此，Rn中平衡正交图的最小能量等于Rn+1中正交图的最小能量，此最小能量为λ2+····+λn+1。

因为1跨越了l的空空间，使用u1（属于kerl）作为r中的向量之一会产生这样的效果，即表示g顶点的所有点都具有相同的第一坐标。这将意味着绘图生活在RN的超平面中，这是不可取的，尤其是当n=2时，所有顶点都将共线。这就是为什么我们省略了第一个特征向量U1。

观察任何正交n×n矩阵q，因为

tr（r>lr）=tr（q>r>lr q）

矩阵RQ还生成最小正交图。这相当于将刚性运动q>应用于r行。

总之，如果λ2>0，在r2中绘制图形的自动方法是：

\1.    计算拉普拉斯L图的两个最小非零特征值λ2≤λ3（如果λ2是多特征值，则可能是λ3=λ2）；

\2.    计算与λ2和λ3相关的两个单位特征向量u2、u3，并让r=[u2 u3]为m×2矩阵，其中u2和u3为列。

\3.    将顶点vi放在坐标为r的第i行的点上，即（ri1，ri2）。

这种方法通常会给出令人满意的结果，但是要注意，由于r可以有相同的行，所以不能保证为不同的节点分配不同的图像。这在实践中似乎并不经常发生。

## 19.2图表示例

现在我们用matlab给出一些例子。其中一些是借用或改编自斯皮尔曼[60]。

例1。考虑具有四个节点的图，其邻接矩阵为

.

我们使用以下程序计算u2和u3：

A=[0 1 1 0；1 0 0 1；1 0 0 1；0 1 1 0]；

d=diag（总和（a））；

L=D-A；

[V，E]=EIGS（L）；gplot（A，V（：，[3 2]）保持；gplot（A，V（：，[3 2]），'O'）

19.2。图形绘图示例

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.gif)

图19.1：示例1中的图形。

示例1的图表如图19.1所示。函数特征值（L）按降序计算L的六个最大特征值和相应的特征向量。结果表明，λ2=λ3=2是一个双特征值。

例2。考虑图18.3所示的图g2，由邻接矩阵给出。

| 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 |
| ---------------------------------------------------- | ---------------------------------------------------- | ---------------------------------------------------- | ---------------------------------------------------- | ----------------------------------------- |
|                                                      |                                                      |                                                      |                                                      |                                           |

我们使用以下程序计算u2和u3：

A=[0 1 1 0 0；1 0 1 1 1；1 1 0 1 0；0 1 0 1；0 1 0 1 0]；

d=diag（总和（a））；

L=D-A；

[V，E]=EIG（L）；gplot（A，V（：，[2 3]）保持

gplot（A，V（：，[2 3]），'O'）

函数eig（l）（结尾没有s）按递增顺序计算l的特征值。绘制图表的结果如图19.2所示。请注意，节点v2被指定为点（0,0），因此此图与图18.3中的图之间的区别在于图19.2的图不是凸的。

例3。考虑以下matlab程序中给出的邻接矩阵a定义的环图：

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.gif)

图19.2：示例2中的图表。

A=diag（1，11，1）；

A=A+A'；

A（1，12）=1；A（12，1）=1；

d=diag（总和（a））；

L=D-A；

[V，E]=EIG（L）；gplot（A，V（：，[2 3]）保持

gplot（A，V（：，[2 3]），'O'）

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.gif)

图19.3：示例3中的图形。

观察我们得到了一个非常漂亮的戒指；见图19.3。同样，λ2=0.2679是一个双特征值（下一对特征值也是如此，除了最后一对，λ12=4）。

19.2。图形绘图示例

例4。在这个由Spielman改编的例子中，我们在单位平方中生成20个随机选择的点，计算它们的Delaunay三角剖分，然后计算相应图的邻接矩阵，最后利用拉普拉斯的第二和第三特征值绘制图。

A=零（20,20）；xy=rand（20,2）；trigs=delaunay（xy（：，1），xy（：，2））；elemtrig=一（3）-眼（3）；对于i=1：长度（trigs），

a（trigs（i，：），trigs（i，：）=elemtrig；结束

A=双（A>0）；gplot（A，xy）D=diag（sum（A））；

L=D-A；

[V，E]=EIGS（L，3，'SM'）；图（2）gplot（A，V（：，[2 1]）保持

gplot（A，V（：，[2 1]），'O'）

图19.4显示了20个点集的Delaunay三角测量和相应图形的绘制。右边的图形看起来比左边的图形好，但不再是平面图形。

00 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1−0.4−0.4−0.3−0.2−0.1 0.1 0.2 0.3 0.4

图19.4：Delaunay三角测量（左）和示例4（右）中图形的绘制。

例5。我们的最后一个例子也借用了斯皮尔曼的著作[60]，与建筑师理查德·巴克明斯特·富勒（1895-1983）发明的测地穹顶“Buckyball”的骨架相对应。蒙特利尔生物圈是巴克明斯特富勒设计的测地穹顶的一个例子。

A=满（Bucky）；

d=diag（总和（a））；

L=D-A；

[V，E]=EIG（L）；gplot（A，V（：，[2 3]）保持；

gplot（A，V（：，[2 3]），‘O’）

图19.5显示了Buckyball的图形。这张照片似乎有点压扁，有两个原因。首先，它实际上是一个三维图；其次，λ2=0.2434是一个三重特征值。（实际上，L的拉普拉斯有许多多重特征值。）我们真正应该做的是用三个与λ2相关的正交特征向量在r3中绘制这个图。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.gif)

图19.5：七叶树图。

下面的matlab程序生成了Buckyball图形的三维图像，其图像如图19.6所示。看起来好多了！

[X，Y]=gplot（A，V（：，[2 3]）；

[X，Z]=gplot（A，V（：，[2 4]）；plot3（X，Y，Z）

## 19.3总结

本章的主要概念和结果如下：

•     图形绘制。

19.3。总结

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.gif)

图19.6:R3中Buckyball的图形。

•     图的矩阵。

•     平衡图绘制。

•     图的能量e（r）。

•     正交图绘制。

•     Delaunay三角测量。

•     巴基鲍尔。