第二十一章
支持向量机和伪逆的应用
我们的原则是，我们的建议者必须保证所有的工作都能顺利完成，而且必须准确无误，申请程序简单易行，我们不知道如何使用这些资源，并考虑到至少要有一个完整的工作流程。瑞尔。《欧洲货币体系》中的“电子商务中心”未经分类的“公平报价”，《欧洲货币体系外部评估》，《欧洲货币体系》中的“公平竞争”部分。
-勒让德，1805年，《轨道测量的新方法》
21.1最小二乘问题和伪逆问题
本章介绍了SVD的几种应用。第一种是伪逆，它在最小二乘法求解线性系统中起着至关重要的作用。第二个应用程序是数据压缩。第三个应用是主成分分析（PCA），其目的是识别数据中的模式并了解数据的方差-协方差结构。第四个应用是一组数据的最佳仿射近似，这是一个与主成分分析密切相关的问题。
最小二乘法是求解超定线性方程组的一种方法。
ax=b，
也就是说，其中a是一个矩形m×n矩阵，方程多于未知方程（当m>n时）。历史上，高斯和勒让德使用最小二乘法来解决天文学和大地测量学中的问题。勒让德于1805年在一篇关于彗星轨道确定方法的论文中首次发表了这一方法。然而，早在1801年，高斯就已经使用最小二乘法来确定小行星的轨道。
六百五十九
在发现小行星帕拉斯之后，他于1810年发表了一篇关于它的论文。顺便说一句，在同一篇文章中，介绍了利用支点进行高斯消元。
在这些问题中，产生的方程多于未知数的原因是为了使误差最小化而重复测量。这就产生了一个超定的，经常不一致的线性方程组。例如，高斯在六个未知数中解出了一个由十一个方程组成的系统来确定小行星帕拉斯的轨道。
例21.1。作为一个具体的例子，假设我们观察一个小物体的运动，被同化到平面上的一个点上。根据我们的观察，我们怀疑这一点沿着直线移动，例如方程y=dx+c。假设我们在三个不同的位置（x1、y1）、（x2、y2）和（x3、y3）观察到移动点。那么我们应该
C+dx1=y1，C+dx2=y2，C+dx3=y3。
如果在我们的测量中没有误差，这些方程将是兼容的，C和D将只由两个方程确定。但是，在出现错误时，系统可能不一致。但是我们想找到C和D！
最小二乘法的思想是确定（c，d），使误差平方和最小化，即，
（C+DX1−Y1）2+（C+DX2−Y2）2+（C+DX3−Y3）2.
见图21.1。

图21.1：给定三个点（x1，y1），（x2，y2），（x3，y3），我们想确定一条线y=cx+d，它将虚线垂直线的长度最小化。
一般来说，对于一个超定的m×n系统ax=b，高斯和勒让德发现有解x最小化

（式中，向量u的欧几里得范数的平方=（u1，…，u n）），这些解由平方n×n系统给出。
a>ax=a>b，
称为法方程。此外，当a的列是线性无关的时，结果表明a>a是可逆的，因此x是唯一的，由
x=（a>a）−1a>b.
注意a>a是一个对称矩阵，是最小二乘法方程的一个很好的特征。例如，由于上述矩阵形式的问题表示为
，
正态方程是
.
事实上，对于任何实M×N矩阵A，总是有一个唯一的最小范数x+，即使A的列是线性相关的，也会最小化。我们如何证明这一点，以及如何找到x+？
定理21.1。每个线性系统a x=b，其中a是m×n矩阵，具有最小范数的唯一最小二乘解x+。
证据。几何为X+的存在和唯一性提供了很好的证明。实际上，我们可以把b解释为欧几里得空间rm中的一个点，把a的图像子空间（也称为a的列空间）解释为rm的子空间u（通过原点）。很明显
，
当u=ima时，我们认为x使kax-最小化，其中p是b在子空间u上的正交投影。
从第12.1节回忆起，正交投影pu:u u→u是由
pu（u+v）=u，
带u∈u和v∈→−u。如果我们让−p=p u（b）∈u，那么对于任意点y∈u，向量py−→=y−p∈u和bp=p b u是正交的，这意味着
，
其中→−b y=y−b。因此，p确实是u中的唯一点，它将b到u中任何点的距离减至最小。见图21.2。

图21.2：给定3×2矩阵a，u=ima是r3中的桃平面，p是b在u上的正交投影。此外，给定y∈u，点b、y和p是直角三角形的顶点。
因此，该问题被简化为证明存在一个唯一的最小范数x+，使得ax+=p，其中p=p u（b）∈u，b对u的正交投影。
RN=KERA（KERA）。
因此，每个x∈rn可以唯一地写成x=u+v，其中u∈kera和v∈（kera），并且由于u和v是正交的，
.
此外，由于u∈kera，我们得到了au=0，因此ax=p iff av=p，这表明x具有最小范数的ax=p的解必须属于（kera）。但是，A到（KERA）的限制是注射性的。这是因为如果a v1=a v2，其中v1，v2∈（kera），那么a（v2−v2）=0，这意味着v2−v1∈kera，并且由于v1，v2∈（kera），我们也有v2−v1∈（kera），因此，v2−v1=0。这表明有一个最小范数的唯一x+，这样ax+=p，x+必须属于
（喀拉邦）。根据前面的推理，x+是最小范数最小的唯一向量。
.
证明还表明，x与u正交，可以用b-ax与a的每一列正交来表示。然而，这相当于
a>（b−ax）=0，即a>ax=a>b。
最后，证明了最小范数最小二乘解x+可以用a的伪逆a+来表示，a的伪逆a+本身就是从a的任意svd得到的。
定义21.1.给定秩r的任何非零m×n矩阵a，如果a=v du>是a的svd，
，
具有
∧=diag（λ1，…，λr）
一个由a的非零奇异值组成的r×r对角矩阵，如果我们让d+是n×m矩阵
，
具有
∧−1=diag（1/λ1，…，1/λr），
a的伪逆定义为
a+=ud+v>。
如果a=0 m，n是零矩阵，我们设置a+=0 n，m。观察d+是通过颠倒d的非零对角线项得到的，保留所有零，然后转置矩阵。例如，给定矩阵
，
它的伪逆是
.
矩阵的伪逆矩阵也称为摩尔-彭罗斯伪逆矩阵。
实际上，a+似乎取决于a的svd（u，d，v）中u和v的具体选择，但是下一个定理表明这不是这样的。
定理21.2。线性系统最小范数的最小二乘解ax=b，其中a是m×n矩阵，由下式得出：
x+=a+b=ud+v>b。
证据。首先假设a是（矩形）对角矩阵d，如上所述。然后，由于x最小化了b在d的图像子空间f上的投影，很明显x+=d+b。否则，我们可以写
a=v du>，
其中u和v是正交的。但是，既然v是等距测量，
kax−bk2=kv du>x−bk2=kdu>x−v>bk2。
假设y=u>x，我们得到kxk2=kkk2，因为u是一个等值线，并且由于u是可预测的，所以当kdy−v>bk2最小化时，kax−bk2最小化，并且我们已经证明了最小解是
Y+=D+V>B。
因为y=u>x，kxk2=kkk2，我们得到
x+=ud+v>b=a+b。
因此，伪逆为最小二乘问题提供了最优解。
根据定理21.2和21.1，a+b由每个b唯一定义，因此a+仅依赖于a。
用于计算矩阵A的伪逆B的matlab命令是b=pinv（a）。
例21.2。如果a是秩2矩阵

其特征值为−1.1652,0,0,17.1652，使用matlab，我们得到了SVD a=v du>

具有
−0.3147
U	=−00..42755402
γ
-0.6530美元
−0.3147
V	=−00..42755402
γ
-0.6530美元	零点七七五二
零点三四二四
-00..09035231
-
-00至77523424
-0.0903个
零点五二三一	零点二六三零
零点零零七五
-0.8039个
零点五三三四
零点五四五二
-0.7658个
-0.1042个
零点三二四七	-0.4805_
0.8366_
-0.2319_
-0.1243个
0.0520_
0.3371_
-0.8301，
零点四四一一

17.1652 0 0_
D=00 1.16520 00 00。
0 0 0 0 0
然后
和	 	零
0.8583 0
零	0 0 0
0 0，
0 0_
0 0	
	 	-00至2200900
-0.0400个
零点一七零零	0.0700 0.0400年
零点零一零零
-0.0200个	0.3600_
0.1700，−0.0200
-0.2100个
这也是通过调用pinv（a）获得的结果。
如果a是n阶的m×n矩阵（因此m≥n），则立即显示
就户主转换而言，QR分解应用如下：
有n个m×m矩阵h1，…，hn，户主矩阵或恒等式，以及一个上三角m×n矩阵r的秩n，这样
a=h1···hnr。
因为每个Hi都是一个等距线，
kax−bk2=krx−hn···h1bk2，
最小二乘问题ax=b等于系统
rx=hn···h1b。现在系统
是这样的
，
其中，R1是可逆n×n矩阵（因为a有秩n），c∈rn，d∈rm−n，最小范数的最小二乘解为
X+=R1−1C。
因为R1是一个三角形矩阵，所以很容易将R1反转。
最小二乘法是数学科学中最有效的工具之一。有很多书都是专门为它写的。建议读者参考Strang[64]、Golub和van Loan[30]、Demmel[16]和Trefethen和Bau[68]，其中描述了最小二乘法（如加权最小二乘法和递归最小二乘法）的扩展和应用。Golub和vanLoan[30]还包含了非常广泛的参考书目，包括关于最小二乘法的书籍列表。

21.2伪逆函数的性质
我们从一个命题开始，这个命题提供了一种计算m×n矩阵a的伪逆的方法，而不需要首先确定SVD分解。
提案21.3.当a具有满秩时，当m≥n时，伪逆a+可表示为a+=（a>a）−1a>，当n≥m时，伪逆a+可表示为a+=a>（aa>）−1。在第一种情况下（m≥n），观察a+a=i，因此a+是a的左逆；在第二种情况下（n≥m），我们有aa+=i，因此a+是a的右逆。
证据。如果m≥n且a具有满秩n，则我们有

带有∧an n×n对角可逆矩阵（带正项），所以
我们发现了
，
会产生
.
因此，如果m≥n且a具有满秩n，则
A+=（A>A）−1a>。如果n≥m且a具有满秩m，则

带∧an m×m对角可逆矩阵（带正项），所以
我们发现了
，
会产生
.
因此，如果n≥m且a具有满秩m，则a+=a>（aa>）-1。
21.2。伪逆的性质
例如，如果，那么a的等级为2，并且由于m≥n，a+=（a>a）−1a>
哪里
.
如果，由于a的秩2和n≥m，则a+=a>（aa>）-1，其中
.
假设a=v∑u>是任意m×n矩阵a的SVD，很容易检查aa+和a+a都是对称矩阵。事实上，
和
从上面的表达式，我们立即推断
AA+A	=	A
A+AA+
还有那个	=	A+，
（AA+）2	=	AA+，
（A+A）2	=	A+A，
所以a a+和a+都是正交投影（因为它们都是对称的）。
提案21.4.矩阵a a+是a范围的正交投影，a+a是k（a）=im（a>）的正交投影，a>的范围。
证据。显然，我们有范围（a a+）范围（a），对于任何y=ax∈范围（a），因为
a a+a=a，我们有
aa+y=aa+ax=ax=y，
所以a a+的图像实际上是a的范围，也很明显，ker（a）ker（a+a），由于aa+a=a，我们还有ker（a+a）ker（a），所以ker（a+a）=ker（a）。
由于a+a是对称的，范围（a+a）=range（（a+a）>）=ker（a+a）=ker（a），如权利要求所述。
提案21.5。集合范围（a）=range（aa+）由所有向量y∈rm组成，这样
，
带z∈rr。
证据。实际上，如果y=ax，那么
，
其中∑r是r×r对角矩阵diag（σ1，…，σr）。相反，如果），则），以及

这表明Y属于A的范围。
同样，我们得到了以下结果。
提案21.6.集合范围（a+a）=ker（a）由所有向量y∈rn组成，这样
，
带z∈rr。
证据。如果y=a+au，那么
，
对于某些z∈rr。相反，如果），则），依此类推。

表示y∈范围（a+a）。

21.2。伪逆的性质
类似的结果适用于复杂矩阵，但在这种情况下，v和u是一元矩阵，a a+和a+a是厄米特正交投影。
如果a是正态矩阵，即aa>=a>a，则a的svd与a的块对角化之间存在密切关系，因此，正态矩阵a的伪逆可以直接从a的块对角化得到。
如果a是（实数）正规矩阵，那么我们从定理16.18知道a可以对一个正交矩阵u进行分块对角化，作为
A=U∧U>，
其中∧是（实数）块对角矩阵
∧=diag（b1，…，bn）
由2×2块模板组成

μj=06，或一维块bk=（λk）。然后我们有以下建议：
提案21.7.对于任何（实）法向矩阵A和任何块对角化a=u∧u>如上所述，a的伪逆由下式给出：
A+=U∧+U>，
其中∧+是∧的伪逆。此外，如果
，
式中，∧r的秩为r，则
.
证据。假设b1，…，bp是2×2块，而λ2p+1，…，λn是标量项。我们知道，数字λj±iμj和λ2p+k是a的特征值，设为ρ2j−1。=

对于j=1，…，p，ρj=λj对于j=2p+1，…，r，？2j=qλ2j+μj2=pdet（bi）。将u乘以适当的置换矩阵，我们可以假定∧的块是有序的，因此，ρ1≥ρ2≥·····························那么很容易看出
a a>=a>a=u∧u>u∧>u>=u∧∧>u>，
具有
∧∧>=诊断（，
因此，ρ1≥ρ2≥············································
∑=diag（σ1，…，σr，0，…，0）、
式中，r=秩（a），σ1≥·································
将∧中的块bi替换为块σ−1bi，其中σ=pdet（bi），将非零标量λj替换为λj/λj，将对角零替换为1。观察到θ是一个正交矩阵
∧=完成∑。
但是我们可以写
A=U∧U>=U完成∑U>，
如果我们让v=u，因为u是正交的，而θ也是正交的，v也是正交的，a=v∑u>是a的svd，现在我们得到
A+=U∑+V>=U∑+成人>U>。
然而，由于θ是一个正交矩阵，所以θ>=θ-1，简单的计算表明
∑+完成>=∑+完成−1=∧+，
得出公式
A+=U∧+U>。
也注意到∧r是可逆的，并且
.
因此，正态矩阵的伪逆矩阵可以直接从A的任何块对角化中计算出来，如所述。
例21.3。考虑下正规矩阵的实对角形式
，
具有
.
21.3。数据压缩和SVD
我们得到
，
A的伪逆是
，
与PINv（a）一致。
由于Penrose的原因，以下特性描述了矩阵的伪逆矩阵。我们已经证明了伪逆满足这些方程。关于相反的证明，见Kincaid和Cheney[39]。
提案21.8。对于任意m×n矩阵a（实矩阵或复矩阵），a的伪逆a+是满足以下特性的唯一n×m矩阵：
a a+a=a，
A+AA+=A+，
（a a+）>=aa+，（a+a）>=a+a。
21.3数据压缩和SVD
在SVD的众多应用中，一个非常有用的应用是数据压缩，尤其是图像压缩。为了使矩阵的紧密性概念更加精确，我们使用了矩阵范数的概念。这一概念在第8章中有定义，读者可能想在进一步阅读之前回顾一下。
给定秩r的m×n矩阵，我们希望通过秩k≤r的矩阵b（实际上，k<r）找到a的最佳近似值，从而使ka−bk2（或ka−bkf）最小化。下面的命题被称为Eckart-Young定理。
提案21.9.设a为秩r的m×n矩阵，v du>=a为a的svd，写出u列的ui，v列的vi，σ1≥σ2≥·······································然后，最接近a（k k2范数）的秩k<r矩阵由下式得出：
diag（σ1，…，σk，0，…，0）u>
kA−akk2=σk+1。
证据。根据结构，AK的等级是K，我们有

诊断（0.
仍然需要证明所有秩k矩阵b的ka−bk2≥σk+1。假设b是任何秩k矩阵，那么它的核具有维数n−k。由（u1，…，uk+1）所跨越的子空间uk+1具有维数k+1，并且因为b和uk+1的核的维数之和是（n−k）+k+1=n+1，t这两个子空间必须在维度至少为1的子空间中相交。选取Ker（b）UK+1中的任何单位向量h。既然bh=0，既然u和v是等距的，我们有
，
这证明了我们的主张。
请注意，AK可以使用（m+n）k项存储，而不是使用mn项。当，这是一个巨大的收益。
例21.4。考虑坏条件对称矩阵

来自第8.5节。既然A是SPD，我们有SVD
具有	A=Udu>，	
−0.5286
U=−00..38035520
γ
-0.5209个
30.2887
D=0	-0.6149 0.3017个
-0.3963-0.0933
0.2716−0.7603
0.6254 0.5676
0 0 0
3.85810个	-0.5016_
0.8304_
-0.2086，
零点一二三七
 
.
_0 0.8431 0_
0 0 0 0.0102

如果我们将σ3=σ4=0，我们得到最佳秩2近似值。
.
demmel[16]第3章第3.2.3节第113-115页给出了在图像压缩中使用21.9号提案的一个很好的例子；见matlab演示。
提案21.9也适用于弗罗贝尼乌斯规范；见问题21.4。
一个有趣的话题我们还没有讨论，那就是SVD的实际计算。这是一个很有趣但很棘手的问题。大多数方法都将SVD的计算简化为选定的对称矩阵的对角化，该对称矩阵不是a>a；见问题20.1和问题20.3。感兴趣的读者应该阅读德梅尔优秀著作[16]的第5.4节，其中包括最著名的方法概述和大量参考文献。
21.4主要成分分析（PCA）
假设我们有一组由N点X1、……Xn组成的数据集，每一个数据都被看作行向量。把XI看成是人，如果X=（XI1，…，XID），每个XIJ都是那个人的某些特征（或属性）的值。
例21.5。例如，XI可以是数学家，D＝2，XI的第一个组成部分XI1可以是XI出生的一年，第二个组成部分XI2是XI的胡须长度厘米。这是一个小数据集。
名字	年	长度
高斯	一千七百七十七	零
卡米尔·若尔当	一千八百三十八	十二
阿德里安-马里·勒让德	一千七百五十二	零
黎曼	一千八百二十六	十五
希尔伯特	一千八百六十二	二
亨利·波因卡	一千八百五十四	五
埃米·诺特	一千八百八十二	零
卡尔·魏尔斯特拉斯	一千八百一十五	零
贝尔特拉米	一千八百三十五	二
与施瓦茨	一千八百四十三	二十
我们通常形成n×d矩阵x，其行是Xi，1的i i小于n，然后用Cj（1×j j）表示JTH列。它有时被称为特征向量，但这个术语远未被普遍接受。其实很多人在计算机视觉上调用了数据点XI的特征向量！
主成分分析（简称PCA）的目的是识别数据模式，了解数据的方差-协方差结构。这对以下任务很有用：
1.	数据简化：通常，数据的许多变量都可以由较少的主成分来解释。
2.	解释：PCA可以显示以前没有被怀疑的关系。
给定一个向量（测量样本）x=（x1，…，xn）∈rn，回想一下x的平均值（或平均值）x由
.
我们让x-x表示中心数据点。
x−x=（x1−x，…，xn−x）。
为了测量XI在平均值附近的传播，我们定义了样本X的样本方差（简称为方差）VaR（x）（或S2）。
例21.6。如果2）和var（x）=
1）和var（
2。
使用n−1而不是n是有原因的。上述定义使var（x）成为被采样随机变量方差的无偏估计量。不过，我们不必为此担心。好奇的读者会在爱泼斯坦[20]中（第14章，第14.5节）或任何像样的统计书中找到对这些特殊定义的解释。
给定两个向量x=（x1，…，xn）和y=（y1，…，yn），x和y的样本协方差（简称协方差）由下式给出：
冠状病毒
例21.7。如果我们取x=（1,3、-1）和y=（0,2、-2），我们从例21.6中知道x−x=（0,2、-2）和y−y=（-1,0,1）。因此，cov（x，y）=0（−1）+2（0）+（2−2）（1）=1。
x和y的协方差度量x和y在平均值上的差异。显然，cov（x，y）=cov（y，x）和cov（x，x）=var（x）。
注意
冠状病毒
我们说x和y是不相关的，iff cov（x，y）=0。
最后，给定n点x的n×d矩阵x，对于PCA是有意义的，有必要将原点翻译成Xi的质心（或重心），由
.
观察，如果μ=（μ1，…，μd），则μj是矢量Cj（x的jth列）的平均值。
我们让x表示一行，它的行是中心数据点XI（1）。那么x的样本协方差矩阵（简称协方差矩阵）就是d×d对称矩阵。
.
例21.8。设3×2矩阵，其列为矢量x和−
例21.6的y。然后和
.
备注：该因素与我们的目的无关，可以忽略不计。
例21.9。下面是我们的胡须数学家的矩阵x−μ：因为
礹1=1828.4，礹2=5.6，
我们得到以下集中的数据集。
	名字	年	长度
	高斯	-51.4美元	5.6
	卡米尔·若尔当	九点六	六点四
	阿德里安-马里·勒让德	-76.4美元	5.6
	黎曼	2.4	九点四
	希尔伯特	三十三点六	3.6
	亨利·波因卡	二十五点六	0.6
	埃米·诺特	五十三点六	5.6
	卡尔·魏尔斯特拉斯	十三点四	5.6
	贝尔特拉米	六点六	3.6
	与施瓦茨	十四点六	十四点四
见图21.3。

图21.3：示例21.9的中心数据点。
我们可以把矢量Cj看作是表示x在ej方向上的特征（rd中的jth规范基矢量，即ej=（0，…，1，…，0），其中1在jth位置）。
如果v∈rd是单位向量，我们希望考虑数据点sd x1，…，xn在v所跨越的直线上的投影。从欧几里德几何中回忆，如果x∈r是任意向量，v∈rd是单位向量，x在v所跨越的直线上的投影是hx，viv。
因此，对于基V，x的投影具有坐标hx，vi。如果x由行向量表示，v由列向量表示，那么
hx，vi=xv。
因此，由x1，…，xn的投影坐标构成的向量y∈rn在V所跨越的线上，由y=xv给出，这是线性组合。
xv=v1c1+·····+vdcd
x列（v=（v1，…，vd））。
观察到，由于μj是矢量cj（x的jth列）的平均值，我们得到
y=xv=v1祄1+····+vd祄d，
因此中心点y−y由

Y−Y=v1（c1−μ1）+·····+v d（cd−μd）=（x−μ）V。
此外，如果y=xv，z=xw，那么
冠状病毒

其中∑是x的协方差矩阵。由于y−y的均值为零，我们得到

这意味着我们应该把原点移动到Xi的质心上，并考虑中心数据点Xi的矩阵X。
从现在开始要注意，我们用c1，…，cd表示x-，y表示圆心，其中v是单位向量。
主成分分析的基本思想：x的主要成分是数据点x1，…，xn的不相关投影y到一些方向v（其中v是单位向量），使得var（y）最大。
这表明了以下定义：
定义21.2.给定数据点X1，…，Xn的N×D矩阵X，如果X是XI的质心，那么X（第一PC）的第一主分量是中心点Y1=（xω）V1，X1，…，Xn投影到方向V1，使得VAR（Y1）被最大化，其中V1是单位向量（回忆Y1＝（x）。-μ）v1是Cj的线性组合，x-μ的柱）。
更一般地说，如果y1，…，yk是x的k主分量，沿着一些单位向量v1，…，vk，其中1≤k<d，x的a（k+1）th主分量（（k+1）th pc）是一个中心点yk+1=（x-μ）vk+1，x1，…，xn在某个方向上的投影vk+1，这样var（yk+1）最大化，subject to cov（yh，yk+1）=0，对于1≤h≤k的所有h，其中vk+1是单位矢量（回想一下，yh=（x−µ）vh是cj的线性组合）。VH被称为主方向。
下面的命题是主成分分析主要结果的关键。这一结果已经在命题16.23中得到证明，只是特征值是按递增顺序列出的。为了读者的方便，我们再次证明了这一点。
提案21.10。如果a是特征值λ1≥λ2≥·····················································

（X=U1时达到最大值）和

（X=UK+1时达到最大值），其中1≤K≤D−1。
证据。首先要注意
，
同样地，
.
由于A是一个对称矩阵，其特征值是实的，它可以相对于特征向量的正态基对角化，因此（u1，…，ud）就是这样的基。如果我们写信
D
x=xxiui，
i＝1
简单的计算表明
.
如果x>x=1，则=1，由于我们假设λ1≥λ2≥·································
.
因此，
，
由于e1（1,0，…，0）达到了这个最大值，我们得出结论
.
接下来观察x∈u1，…，uk和x>x=1 iff x1=····=xk=0和
因此，对于这样一个x，我们有
.
因此，
，
由于Ek+1的最大值为（0，…，0,1,0，…，0），位置k+1为1，我们得出结论：
，
如要求。
数量

被称为瑞利比或瑞利-瑞兹比（见第16.6节），而21.10命题通常被称为瑞利-瑞兹定理的一部分。
命题21.10也适用于如果a是厄米特矩阵，并且如果我们用x ax替换x>ax，x>x替换x x，则证明是不变的，因为厄米特矩阵具有实际特征值，并且相对于特征向量的正交基（关于厄米特内积）对角化。
然后，我们将得到以下基本结果，说明X的SVD如何生成PC：
定理21.11。（SVD产生PCA），X为数据点X1，…，Xn的N×D矩阵，并设为Xi的质心。如果X＝＝V DU>是X×SVD的SVD分解，如果D的主对角线由奇异值α1×2以上的±·ω-δD组成，则中心点Y1，…，YD，WH。埃尔
yk=（x−μ）uk=v d的第k列
Uk是u的第k列，是x的d个主要成分。

而cov（yh，yk）=0，当h=6 k且1≤k时，h≤d。
证据。回想一下，对于任何单位向量v，点x1，…，xn在方向v的直线上的中心投影是y=（x-μ）v，y的方差由下式得出：

由于x−μ=v du>，我们得到

同样，如果y=（x−μ）v和z=（x−μ）w，则y和z的协方差由下式得出：
冠状病毒
显然，u（n−11）d2u>是一个特征值为的对称矩阵，u的列构成了单位特征向量的正交基。
我们对k进行归纳。对于基本情况，k=1，最大化var（y）等于最大化

其中v是单位向量。由命题21.10可知，上述数量的最大值是最大特征值，即，对于u的第一列u1，我们得到
y1=（x−µ）u1=v du>u1，
由于u的列构成正交基，u>u1=e1=（1,0，…，0），所以y1确实是v d的第一列。
根据诱导假设，中心点y1，…，yk，其中yh=（x−µ）uh和u1，…，u k是u的前k列，是x的k主要成分。因为
冠状病毒
式中，y=（x−μ）v和z=（x−μ）w，条件cov（y h，z）=0，对于h=1，…，k等于w属于由u1，…，uk所跨越的子空间的正交补集，并且服从cov（yh，z）=0，对于h=1，…，k等于最大化。

其中w是一个与子空间正交的单位向量，其范围为u1，…，uk。按命题
21.10，上述数量的最大值为（k+1）的第（k+1）个特征值，即
它是为英国+1，美国的第（k+1）列而实现的。
YK+1=（x−µ）UK+1=V du>UK+1，
由于u列构成正交基，u>u k+1=ek+1，yk+1确实是v d的（k+1）第（k+1）列，完成了诱导步骤的证明。
u的d列u1，…，ud通常称为x−礹（和x）的主方向。我们注意到，不仅当h=6K时，cov（yh，yk）=0，而且数据投影的方向u1，…，ud是相互正交的。
例21.10。对于胡须数学家的中心数据集（例21.9），我们有x−µ=v∑u>，其中∑有两个非零奇异值，σ1=116.9803，σ2=21.7812，以及
，
-
所以主方向是2=（0.0325，−0.9995）。观察u1几乎是x轴的方向，u2几乎是y轴的相反方向。我们还发现沿着主方向的投影y1和y2是
−51.5550 3.9249−51.4000−5.6000
9.8031−6.0843 9.6000 6.4000
−76.5417 3.1116−76.4000−5.6000−2.0929−9.4731−2.4000 9.4000
γ
γ
	
53.3894 7.3408_
	
13.2107 6.0330_
	
6.4794 3.8128_
15.0607−13.9174见图21.4、21.5和21.6。	γ
53.6000
γ
13.4000
γ
6.6000
14.6000美元	 
V D=2533..56694651 14..43256912，X 3325..60006000−30..60006000。

图21.4：实施例21.9的中心数据点和实施例21.10的两个主要方向。

图21.5：实施例21.10的第一个主要组成部分，即中心数据点在U1线上的投影。


图21.6：实施例21.10的第二个主要组成部分，即中心数据点在U2线上的投影。
我们从对SVD的研究中知道，对称半正定矩阵（x−礹）>（x−礹）的特征值和u1，…，ud是相应的特征向量。在数值上，最好在x−μ上使用SVD，而不是显式计算（x−μ）>（x−μ），然后对其进行对角化。事实上，从矩阵A显式计算a>a可能在数值上相当不稳定，而且好的SVD算法避免显式计算a>a。
一般来说，由于x的svd不是唯一的，所以主方向u1，…，ud不是唯一的。当数据集具有某些旋转对称性时，就会发生这种情况，在这种情况下，PCA不是一种很好的数据集分析方法。
21.5最佳仿射近似
一个非常接近PCA的问题（和基于最小二乘法）是最好地逼近一个N点X1，…，Xn的数据集，用X-RD，用RD的p维仿射子空间A，用1个±p＝D 1（术语等级D P）也使用。
首先考虑P=D-1。那么a=a1是仿射超平面（在rd中），它由形式方程给出。
A1x1+·····+ADxd+c=0.
通过最佳逼近，我们的意思是（a1，…，ad，c）解齐次线性系统。

在最小二乘意义上，服从A=（A1，…，AD）是单位向量的条件，即A＞A＝1，其中X=（XI1，FAY·，XID）。如果我们形成对称矩阵

在正规方程中，我们看到矩阵的最下面一行（和最后一列）是
n礹1···n礹d n，
其中乘以x的cj列的平均值。
因此，如果（a1，…，ad，c）是一个最小二乘解，也就是说，一个正态方程的解，我们必须
n礹a1+·····+n礹dad+nc=0，
也就是说，A1礹1+·····+AD礹d+C=0，
这意味着超平面A1必须通过数据点x1，…，xn的质心。然后，我们可以重写原始系统相对于中心数据Xi，发现变量C退出，得到系统。
（x−μ）a=0，
其中a=（a1，…，ad）。
因此，我们在寻找一个单位向量a，在最小二乘意义上求解（x−μ）a=0，也就是说，一些a，使得a>a=1最小化
A>（X−礹）>（X−礹）A.
计算x−μ的一些svd v du>值，其中d的主对角线由x−μ的奇异值σ1≥σ2≥·······························然后
a>（x−礹）>（x−礹）a=a>ud2u>a，
其中d2=diag（）是一个对角矩阵，所以选择a作为u中的最后一列
（对应于（x−μ）>（x−μ）的最小特征值σd2）。这是我们最适合的问题的解决方案。
因此，如果ud−1是由a定义的线性超平面，也就是说，
ud−1=u∈rd hu，ai=0，
其中a是x−μ的某些svd v du>的u中的最后一列，我们已经证明仿射超平面a1=μ+ud−1是最小平方意义上的数据集x1，…，xn的最佳近似值。
很容易证明，超平面A1=ω+UD 1最小化了每个XI的平方距离与A1上的正交投影的平方之和。此外，由于u d−1是u的最后一列a的正交补码，我们发现ud−1由u的第一个d−1列（即x−µ的第一个d−1主方向）构成。
所有这些都可以推广到一个最佳（d−k）维仿射子空间ak，在最小二乘意义上近似于x1，…，xn（1≤k≤d−1）。这样的仿射子空间ak由k独立超平面hi（1≤i≤k）切出，每个超平面由一些方程给出。
ai1x1+·····+aidxd+ci=0.
如果我们写ai=（ai1，···，aid），表示hi是独立的，意味着a1，…，ak是线性独立的。事实上，我们可以假设a1，…，ak形成一个正态系统。
然后找到一个最佳的（d−k）维仿射子空间AK等于解齐次线性系统。
，
在最小二乘意义上，在a>i a j=δij的条件下，对于所有i，j，1≤i，j≤k，其中系统矩阵是由k个对角块（x，1）组成的块对角矩阵，其中1表示列向量（1，…，1）∈rn。
很容易看出，每个超平面Hi必须通过x1，…，xn的质心，并且通过切换到中心数据Xi，我们得到该系统。
，
a>i a j=δij，对于所有i，j，1≤i，j≤k。
如果v d u>=x−µ是一个SVD分解，很容易看出这个系统的最小二乘解是由u的最后k列给出的，假设d的主对角线由x−µ的奇异值σ1≥σ2≥···································但是现在，由a1，…，ak定义的超平面切出的（d−k）维子空间ud−k只是（a1，…，ak）的正交补码，它是由u的第一个d−k列所跨越的子空间。
因此，在最小二乘意义上，最好的（d−k）维仿射子簇ak近似于x1，…，xn是
ak=μ+ud−k，
其中，u d−k是由x−μ的第一个d−k主方向（即u的第一个d−k列）所跨越的线性子空间。因此，我们得到了以下有趣的PCA解释（实际上，主方向）：
定理21.12。设X是数据点X1、…、Xn的N×D矩阵，并设为Xi的质心。如果X＝＝V DU>是X×SVD的SVD分解，如果D的主对角线是由奇异值α1×2以上的ω-ω-ωd，则是一个最好的（d×k）维仿射逼近A。k的x1，…，xn在最小二乘意义上由下式给出
ak=μ+ud−k，
其中，u d−k是由u的第一个d−k列跨越的线性子空间，x−（1≤k≤d−1）的第一个d−k主方向。
例21.11。回到实施例21.10，最好的一维仿射近似值a1是穿过U1=（0.9995,0.0325）方向（μ1，μ2）=（1824.4,5.6）的仿射线。
例21.12。假设在示例21.5的数据集中，我们将每个数学家的出生月份添加为一个特征。我们得到以下数据集。
名字	月	年	长度
高斯	四	一千七百七十七	零
卡米尔·若尔当	一	一千八百三十八	十二
阿德里安-马里·勒让德	九	一千七百五十二	零
黎曼	九	一千八百二十六	十五
希尔伯特	一	一千八百六十二	二
亨利·波因卡	四	一千八百五十四	五
埃米·诺特	三	一千八百八十二	零
卡尔·魏尔斯特拉斯	十	一千八百一十五	零
贝尔特拉米	十	一千八百三十五	二
与施瓦茨	一	一千八百四十三	二十
第一列的平均值为5.2，中心数据集如下。
名字	月	年	长度
高斯	1.2	-51.4美元	5.6
卡米尔·若尔当	4.2	九点六	六点四
阿德里安-马里·勒让德	三点八	-76.4美元	5.6
黎曼	三点八	2.4	九点四
希尔伯特	次级方案4.2	三十三点六	3.6
亨利·波因卡	1.2	二十五点六	0.6
埃米·诺特	2.2	五十三点六	5.6
卡尔·魏尔斯特拉斯	四点八	十三点四	5.6
贝尔特拉米	四点八	六点六	3.6
与施瓦茨	四点二	十四点六	十四点四
-
117.0706	零
22.0390年
零
零
零
零
零
零
零
零	0℃
0℃
10.1571_
0_
0 0，
0_
0_
0_
零
γ
γ
γ
γ
γ
d=
γ
γ
γ
γ
γ
γ
γ	零
零
零
零
零
零
零
零
零		

在这个数据集上运行SVD
 	零点一七一七
零点零三九零
-0.9844个	，
和
 	三点三零一三
-6.6467个
三点一八四五
-8.6943页
4.1334 1.3833 7.2258 6.8594
四点六二五四	-3.8569_
-2.7082_
0.2348_
5.2872_
-3.6415_
-0.4350_
-1.3547_
4.2010年
4.3212_
−15.2173−14.3266−1.1581
−1.2000
−4.2000 3.8000
γ
3.8000
γ
−4.2000
x_−1.2000
γ
γ
−2.2000
γ
4.8000
γ
4.8000
-4.2000美元	-51.4000美元
九点六零零零
-76.4000美元
-2.4000个
33.6000 25.6000
53.6000美元
13.4000 6.6000
14.6000美元	-5.6000_
6.4000_
-5.6000_
9.4000−3.6000−0.6000。-5.6000_
-5.6000_
-3.6000_
14.4000元
第一个主方向U1=（0.0394、-0.9987、-0.0327）基本上与Y轴相反，最显著的特征是出生年份。第二个主要方向u2=（0.1717,0.0390，−0.9844）靠近Z轴的对面，第二个最显著的特征是胡须的长度。最佳仿射平面由向量u1和u2确定。
PCA在数据压缩、降维和模式分析中有许多应用。其基本思想是，在许多情况下，给定数据集X1，…，Xn，Xi，RD RD，只有一个“小”子集的特征的MD D需要准确地描述数据集。
如果U1，…，ud是x−祄的主方向，那么数据的第一个m投影（第一个m主分量，即v d的第一个m列）在第一个m主方向上表示数据，而不会丢失太多信息。因此，代替使用原始数据点X1，…，Xn，用Xi×RDM，我们可以将它们的投影应用到第一M主方向Y1，…，YM，其中Yi-r R和M< D，获得原始数据集的压缩版本。
例如，PCA用于计算机视觉中的人脸识别。Sirovitch和Kirby（1987）似乎是第一个想到使用PCA压缩面部图像的人。他们引入了“本征图”这个术语来指代主方向，即用户界面。然而，只有在Turk和Pentland（1991）之后才给出了一种明确的人脸识别算法。他们把本征图片改名为本征面。

21.6。总结
有关Eigenfaces主题的详细信息，请参阅Forsyth和Ponce[21]（第22章，第22.3.2节），在这里您还可以找到Turk和Pentland论文的确切参考。
PCA的另一个有趣的应用是手写数字的识别。这种应用在黑斯提、提比西拉尼和弗里德曼[34]中有描述（第14章，第1节）。
14.5.1条）。
21.6总结
本章的主要概念和结果如下：
•	最小二乘问题。
•	最小范数最小二乘解的存在性（定理21.1）。
•	矩阵A的伪逆A+。
•	最小范数的最小二乘解由伪逆给出（定理21.2）
•	伪逆的投影属性。
•	正态矩阵的伪逆矩阵。
•	伪逆的彭罗斯特征。
•	数据压缩和SVD。
•	矩阵秩小于r的最佳近似。
•	主成分分析。
•	回顾基本统计概念：均值、方差、协方差、协方差矩阵。
•	中心数据，质心。
•	主要成分（PCA）。
•	瑞利-里兹定理（定理21.10）。
•	主定理：SVD产生PCA（定理21.11）。
•	最佳仿射近似。
•	SVD产生最佳仿射近似（定理21.12）。
•	人脸识别，特征面。
21.7问题
问题21.1。考虑单变量x中的超定系统：
a1x=b1，…，amx=bm。
证明了最小范数的最小二乘解由
.
问题21.2。设x为m×n实矩阵。对于任何严格正常数k>0，矩阵x>x+kin是可逆的。证明当k为零时，矩阵（x>x+kin）−1X>的极限等于x的伪逆x+。
问题21.3。用matlab求8×6矩阵的伪逆
64
9
17
γ
40 A=32
γ
γ
41
γ
49
八	二
五十五
四十七
二十六
三十四
二十三
十五
五十八	3 54
四十六
二十七
三十五
二十二
十四
五十九	六十一
十二
二十
三十七
二十九
四十四
五十二
五	六十
十三
二十一
三十六
二十八
四十五
五十三
四	6℃
51℃
43_
30 38。
19_
11_
六十二
观察各列的总和均等于256。设b为坐标均等于256的维度6的向量。找到系统的解决方案x+，ax=b。
问题21.4。这个问题的目的是证明21.9命题（Eckart-Young定理）也适用于Frobenius规范。这个问题是根据Strang改编的
[65]，第I.9节。
假设秩至多k的m×n矩阵b使ka−bkf最小化。从B的SVD开始，
，
其中d是对角线k×k矩阵。我们可以写信
，
其中，在前k行中，l是严格的下三角形，e是对角的，r是严格的上三角形，并
，
21.7。问题
等级明显小于k。
(1)	证明这一点
.
因为kA−bkf是最小的，所以表明l=r=f=0。同样，显示g=0。
(2)	我们有
，
其中e是对角线，所以推断
1.	d=diag（σ1，…，σk）。
2.	h的奇异值必须是a的最小n-k奇异值。
3.	kA−bkf的最小值必须为khkf=（σk2+1+·····+σr2）1/2。
问题21.5。证明矩阵的最近秩1近似（k k2）
是
.
证明了Eckart-Young定理对于算子范数k k来说是失败的，因为找到了一个秩
无穷大
1矩阵B，使ka−bk<ka−a1k。
∞∞
问题21.6。求矩阵的最近秩1近似值（k k2）
.
问题21.7。求矩阵的最近秩1近似值（k k2）
.
问题21.8。设为实对称正定矩阵，设s=u∑u>为s的对角化，证明最接近的秩1矩阵（在l2范数中），其中u1是u的第一列。