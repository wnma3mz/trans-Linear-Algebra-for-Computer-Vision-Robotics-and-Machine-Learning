第四章

# Haar基，Haar小波，Hadamard矩阵

在本章中，我们将讨论两种在计算机科学和工程中有应用的矩阵：

（1）haar矩阵和相应的haar小波，是信号处理和计算机图形学的基本工具。

2）哈达玛矩阵在纠错码、信号处理和低阶近似中有应用。

## 4.1使用HAAR小波的信号压缩介绍

我们首先考虑r4中的haar小波。小波在音频和视频信号处理中起着重要的作用，尤其是在将长信号压缩成更小的信号时，这些信号仍然保留着足够的信息，因此在播放时，我们看不到或听不到任何差异。

考虑四个向量w1，w2，w3，w4，由

.

请注意，这些向量是成对正交的，因此它们确实是线性无关的（我们将在后面的章节中看到这一点）。让w=w1，w2，w3，w4作为haar基础，并让

u=e1，e2，e3，e4是r4的规范基础。基矩阵w=pw，u从

一百零一

u到w由

，

我们很容易发现w的倒数由

.

因此，u基上的向量v=（6,4,5,1）在haar基上变成c=（c1，c2，c3，c4）。

W，带

.

给定一个信号v=（v1，v2，v3，v4），我们首先通过计算c=w−1v将v转换为其系数c=（c1，c2，c3，c4）。观察

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.gif)

是信号v的总平均值。系数c1对应于图像（或声音）的背景。然后，c2给出v的粗略细节，而c3给出v的第一部分的细节，c4给出v的下半部分的细节。

信号重建包括计算v=wc。好的压缩技巧是去掉C的一些系数（设置为零），获得一个压缩的信号C，并且仍然保留足够的关键信息，以便重建的信号V=wc b b b看起来几乎和原始信号V一样好。因此，步骤是：输入V−→系数c=w−1v−→压缩c−→压缩v=wc。B-B

这种压缩方案使现代视频会议成为可能。

事实证明，在不实际使用w-1的情况下，有一种更快的方法可以找到c=w-1v。这与Haar小波的多尺度性质有关。

给出图4.1所示的原始信号v=（6,4,5,1），我们计算平均值和半差，得到图4.2。我们得到系数c3=1和c4=2。然后我们再次计算平均值和半差，得到图4.3。我们得到系数c1=4和c2=1。注意，原始信号V可以从两个信号中重建


 

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.gif)

V＝14

图4.1：原始信号v。

1=C=V-V 3 2=C 4=v3-v4 2

V+V 1 2 V+V 3 4-12 2-v3-v4

2 2 2

图4.2：第一个平均值和上半年的差异。

在图4.2中，图4.2左侧的信号可以从图4.3中的两个信号中重建。特别是，图4.2中的数据给出了

.

## 4.2 Haar基和Haar矩阵，Haar小波的尺度特性

第4.2节中讨论的方法可推广到任何长度2n的信号。前一种情况对应于n=2。让我们考虑n=3的情况。哈尔基

| 网络错误 |      | 网络错误 | 网络错误 | 网络错误 |
| -------- | ---- | -------- | -------- | -------- |
|          |      |          |          |          |

V+V-V-V1 2 3 4

C＝

一

V+V+V+V1 2 3 4

C=1−1−1

四

图4.3：第二个平均值和下半年的差异。

（w1，w2，w3，w4，w5，w6，w7，w8）由矩阵给出

1 1 0 1 0 0 0_

1 1 0−1 0 0 0 1 1−1 0 0 1 0 0

γ

1 1−1 0 0−1 0 0

γ

W=1−1 0 1 0 0 1 0。

                                              

1−1 0 1 0 0−1 0_

                                              

1−1 0−1 0 0 0 1

1−1 0−1 0 0 0−1

这个矩阵的列是正交的，很容易看出

w−1=diag（1/8,1/8,1/4,1/4,1/2,1/2,1/2,1/2）w>。

一种模式开始出现。看起来第二个haar基向量w2是所有其他基向量的“母亲”，除了第一个，它的目的是执行平均。实际上，一般来说，

W2=（1，…，1，−1，……，−1）

|新西兰2

其他的haar基向量是通过“缩放和移动过程”获得的。从w2开始，缩放过程生成向量。

W3，W5，W9，…，W2J+1，…，W2N−1+1，

这样，W2J+1+1通过形成两个连续的块（1和−1是W2J+1中块大小的一半），并将所有其他条目设置为零，从W2J+1获得。观察W2J+1有2J块2N−J元素。移位过程包括将w2j+1中的1和−1块向右移动，方法是从左侧插入一个（k−1）2n−j零块，其中0≤j≤n−1和1≤k≤2j。请注意，我们的约定是使用j作为缩放索引，k作为移位索引。因此，我们得出W2J+K的公式如下：

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image005.gif)

当0≤j≤n−1和1≤k≤2j.当然

.

如果我们通过让k从0到2j−1变化，并使用索引j而不是2j来稍微改变我们的索引，上面的公式看起来会更好一些。

定义4.1.维2n的haar基向量表示为

，

哪里

0 1≤i≤k2n−j

__

j 1 k2n−j+1≤i≤k2n−j+2n−j−1

hk（i）=0−k（k2n+1）2−j+2n−nj+1−1+1≤i≤≤i2≤n，（k+1）2n−j 1

当0≤J≤N−1和0≤K≤2J−1时。列为向量的2n×2n矩阵

，

（按这个顺序），称为维2n的haar矩阵，用wn表示。

结果表明，如果我们将向量u=（u1，…，um）解释为区间[0,1]上的分段线性函数，有一种更好地理解这些公式的方法。

定义4.2.给定一个向量u=（u1，…，um），分段线性函数plf（u）被定义为plf（u）（x）=ui，

换句话说，函数plf（u）在间隔[0,1/m]上具有值u1，在[1/m，2/m]上具有值u2，在间隔[m−1/m，1]上具有值um。

例如，与向量关联的分段线性函数

U=（2.4、2.2、2.15、2.05、6.8、2.8、−1.1、−1.3）

如图4.4所示。

然后每个基向量hjk对应于函数

ψkj=plf（hjk）。

特别是，对于所有n，haar基向量

h00=w2=（1，…，1，−1，…，−1）

|新西兰

二

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.gif)

图4.4：分段线性函数plf（u）。

得出相同的分段线性函数ψ，由

| 网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误 |
| ---------------------------------------------------- | -------- |
|                                                      |          |

如图4.5所示。很容易看出这是由简单表达式给出的

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.gif)

图4.5：Haar小波ψ。

ψk j（x）=ψ（2jx−k），0≤j≤n−1，0≤k≤2j−1。

上面的公式表明，ψkj是由ψ通过缩放和移动得到的。

定义4.3.函数）是一个分段线性函数，常数值为[0,1]上的1，函数ψkj=plf（hjk）与haar子波一起称为haar子波。

我们可以使用更快的算法，使用平均和差分，而不是使用w−1在haar基础上将向量u转换为系数的向量c，并使用矩阵w从haar系数c重建向量u。

如果c是维2n的Haar系数的向量，我们计算向量u0，u1，…，un的序列如下：

U0= C

UJ+1=UJ

UJ+1（2I−1）=UJ（I）+UJ（2J+I）UJ+1（2I）=UJ（I）−UJ（2J+I）、

对于j=0，…，n−1和i=1，…，2j，重构向量（信号）为u=un。

如果u是维2n的向量，我们计算向量cn、cn-1、…、c0的序列如下：

CN= U

Cj=Cj+1

Cj（i）=（Cj+1（2i−1）+Cj+1（2i））/2 Cj（2j+i）=（Cj+1（2i−1）−Cj+1（2i））/2，

对于j=n−1，…，0和i=1，…，2j，Haar基上的向量是c=c0。

我们把它作为一个练习，用两个变量u和c在matlab中实现上述程序，并通过迭代构建2j，这里是一个将n=3的向量转换为其haar系数的例子。

给定序列U=（31,29,23,17、-6、-8、-2、-4），我们得到序列

，

所以c=（10,15,5，−2,1,3,1,1）。相反地，给定c=（10,15,5、-2,1,3,1,1），我们得到序列

U0=（10,15,5，−2,1,3,1,1）

U1=（10+15,10−15,5、−2,1,3,1,1）=（25、−5,5、−2,1,3,1,1）U2=（25+5,25−5、−5+（−2），−5−（−2），1,3,1,1）

=（30,20、−7、−3,1,3,1,1）

U3=（30+1,30−1,20+3,20−3、−7+1、−7−1、−3+1、−3−1）

=（31、29、23、17、−6、−8、−2、−4）

它返回u=（31、29、23、17、-6、-8、-2、-4）。

## 4.3哈尔矩阵的克罗内克产品结构

有另一种递归方法构造维数2n的haar矩阵wn，这使得wn的列是成对正交的，以及为什么上述算法确实是正确的（似乎没有人证明！）.如果我们将wn分解为两个2n×2n-1矩阵，那么包含wn最后2n-1列的第二个矩阵具有非常简单的结构：它由向量组成。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image009.gif)

以及2n−1−1移位的副本，如下图所示，n=3：

1 0 0 0−1 0 0 0

0 1 0 0 0−1 0 0 0 1 0。

                                                        

0 0−1 0_

                                                        

0 0 1_

0 0 0 0−1

注意，在我们的例子中，这个矩阵可以从单位矩阵I2n-1中获得。

，

通过形成2n×2n−1矩阵，用列向量替换每个1得到矩阵

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image011.gif)


 

4.3。哈尔矩阵的克罗内克积构造

以及每一个零点的列向量

.

现在，wn的前半部分，即由wn的前2n-1列组成的矩阵，可以通过形成2n×2n-1矩阵从wn-1中获得，该矩阵通过用列向量替换每个1获得。

每个−1的列向量

，

以及每一个零点的列向量

对于n=3，w3的前半部分是矩阵

1 1 0_

1 1 0_

1 1−1 0_

1 1−1 0 1−1 0 1

γ

                                                           

1−1 0 1_

                                                           

1−1 0−1 1−1 0−1

这确实是从

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image013.gif)

使用我们刚才描述的过程。

这些矩阵操作可以通过对被称为Kronecker产品的矩阵进行产品操作来方便地描述。

定义4.4.给定m×n矩阵a=（aij）和p×q矩阵b=（bij），a和b的Kronecker积（或张量积）a b是mp×nq矩阵。

| ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image015.gif) | 网络错误 | 网络错误 | ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image017.gif) |
| ------------------------------------------------------------ | -------- | -------- | ------------------------------------------------------------ |
|                                                              |          |          |                                                              |

A B=…······…………。

AM1B AM2B···AMNB

可以看出是关联的，并且

（a b）（c d）=ac bd

（a b）>=a>b>，

只要AC和BD定义良好。然后立即通过以下简洁的递推方程验证Wn：

，

用w0=（1）。如果我们让

对于n≥1，

因此，用Kronecker产品公式对方程进行严格的证明并不困难。

，对于所有n≥1。

上述方程清楚地证明了wn的柱是成对正交的。

观察右块（尺寸为2n×2n−1）清楚地显示了如何在n−1步后将向量c后半部分中的细节系数相加并减去到部分重建向量后半部分中的条目中。

## 4.4基于HAAR的多分辨率信号分析

HAAR基础的一个重要和有吸引力的特点是它提供了信号的多分辨率分析。事实上，给定信号u，如果c=（c1，…，c2n）是其haar系数的矢量，低指数的系数给出关于u的粗略信息，高指数的系数表示精细信息。例如，如果u是一个对应于管弦乐队演奏的莫扎特协奏曲的音频信号，c1对应于“背景噪声”，c2对应于低音，c3对应于第一大提琴，c4对应于第二大提琴，c5，c6，c7，c7对应于中提琴，那么小提琴等。小波的多分辨率特性可以被用来压缩信号，也就是说，用更少的系数来表示它。下面是一个例子。考虑信号

U=（2.4、2.2、2.15、2.05、6.8、2.8、−1.1、−1.3），

其haar变换为c=（2,0.2,0.1,3,0.1,0.05,2,0.1）。

4.4。基于HAAR基的多分辨信号分析

与u和c对应的分段线性曲线如图4.6所示。由于c中的一些系数很小（小于或等于0.2），我们可以用0替换它们来压缩c。我们得到c2=（2,0,0,3,0,0,2,0），

重建信号是

U2=（2,2,2,2,7,3、−1、−1）。

图4.7显示了对应于u2和c2的分段线性曲线。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image019.gif)

图4.6：信号及其haar变换。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image020.gif)

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 00 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1图4.7：压缩信号及其压缩HAAR变换。

HAAR小波的一个有趣的（有趣的）应用是音频信号的压缩。事实证明，如果您的类型在matlab中加载handel，音频文件将加载到y表示的向量中，如果您键入sound（y），计算机将播放这段音乐。你可以把y转换成haar系数c的向量，y的长度是73113，

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image021.gif)

−0.80 1 2 3 4 5 6 7−0.80 1 2 3 4 5 6 7 x 104 x 104

图4.8：信号“handel”及其haar变换。

因此，首先对y的尾部进行tuncate，得到长度为65536=216的向量。图4.8显示了与y和c对应的信号图。然后运行一个程序，将绝对值小于0.05的C的所有系数设置为零。这将37272系数设置为0。结果向量c2被转换成信号y2。Y2和C2对应的信号图如图4.9所示。当你输入声音（Y2）时，你会发现音乐没有差别

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image022.gif)

0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 x 104 x 104

图4.9：压缩信号“handel”及其haar变换。

虽然听起来不那么清脆，但与原版有很大不同。你应该和其他大于或小于0.05的数字一起玩。你应该听到当你输入声音（c）时会发生什么。它播放与y的haar变换c相对应的音乐，非常有趣。


 

## 4.5数字图像的HAAR变换

HAAR变换的另一个优点是它可以立即推广到矩阵（甚至矩形）而不需要任何额外的努力！这样可以压缩数字图像。但首先，我们讨论了HAAR系数的归一化问题。正如我们之前所观察到的，haar基向量的2n×2n矩阵wn具有正交列，但其列没有单位长度。因此，不是wn的逆矩阵，而是

DN=诊断

.

定义4.5.正交矩阵

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image024.gif)

其列是标准化的haar基向量，

=迪亚格

称为归一化Haar变换矩阵。给定一个向量（信号）u，我们称之为u的归一化haar系数。

因为hn是正交的。

然后一瞬间的思考表明，我们必须稍微修改计算算法和hnc，如下所示：当计算ujs的序列时，使用

，

当计算cjs的序列时，使用

.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image025.gif)

注意，现在情况更加对称，以√2除法为代价。然而，对于长向量，这些算法在数值上更稳定。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image026.gif)

备注：部分作者（如Stollnitz、Derose和Salesin[62]）将c重新缩放1/√2n

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image027.gif)

u乘以√2n，这是因为基函数ψkj的范数不等于1（内积下）。归一化基函数是函数

.

现在让我们解释一下HAAR转换的二维版本。我们使用矩阵wn来描述版本，使用hn的方法是相同的（除了，但这不适用于wn-1）。给定一个2 m×2n矩阵A，我们可以首先使用haar变换wn-1将a的行转换为其haar系数，获得矩阵b，然后使用矩阵wm-1将b的列转换为其haar系数。因为列和行是在第一步交换的，

B=A（wn-1）>，

在第二步c=wm−1b，因此，我们

.

在另一个方向上，给定一个2 m×2n的haar系数矩阵c，我们首先将wm应用于c的列，得到b，然后再应用于b的行，从而重建矩阵a（图像）。

.

当然，我们实际上不需要转换wm和wn，也不需要执行矩阵乘法。

我们只需要使用平均和差分的算法。下面是一个例子。如果数据矩阵（图像）是8×8矩阵

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误                    | 网络错误   网络错误   网络错误   网络错误   网络错误         | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |

如我们所见，C的零项多于A；它是A的压缩版本。我们可以通过设置为0进一步压缩C，所有绝对值的项至多为0.5。然后我们得到

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image029.gif) | 网络错误   网络错误   网络错误   网络错误                    | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 |
| 网络错误                                                     |                                                              |                                                              |

结果表明，matlab有一个很好的命令image（x）（也就是imagesc（x），它通常做得更好），它显示矩阵x有一个图像，其中每个条目显示为一个小正方形，其灰度与该条目的数值成比例（如果值更高，则更轻，如果该值接近零，则变暗；负值被视为零）。A和C对应的图像如图4.10所示。这个

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image032.gif)

图4.10：图像及其haar变换。

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image034.gif)

图4.11：压缩图像及其HAAR变换。

A2和C2对应的压缩图像如图4.11所示。压缩版本似乎与原始版本不可区分！

如果我们使用归一化矩阵hm和hn，那么图像矩阵a及其归一化haar变换c的相关方程是

c=hm>ahn a=hmchn>。

HAAR转换还可以用于在互联网上逐步发送大图像。实际上，我们可以从最粗的系数（第一列自上而下，然后第二列等）开始发送矩阵c的haar系数，在接收端，我们可以在收到足够的数据后立即开始重建图像。

注意，我们可以执行部分编码（和解码），而不是对每一行和每一列执行所有轮的平均和差分。例如，我们可以对每一行和每一列执行一轮平均和差分。结果是一个包含四个子图像的图像，其中左上角的四分之一是原始图像的较粗版本，其余的（由三个部分组成）包含最精细的细节系数。我们还可以执行两轮平均和差分，或三轮等。第二轮平均和差分应用于图像的左上角。通常，第k轮应用于由前一轮结束时获得的矩阵的前2 m+1−k行和前2 n+1−k列（1≤k≤n）组成的2 m+1−k子矩阵。该过程如图4.5所示。执行一轮、两轮、三轮和九轮平均的结果如图4.13所示。由于我们的图像大小为512×512，九轮平均将生成haar转换，显示为右下角的图像。原来的图像已经完全消失了！我们将它作为一个有趣的练习来修改涉及平均和差分的算法，以执行k轮平均/差分。重建算法是

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image036.jpg)

图4.12：杜勒的原始图纸。

有点棘手。

在Stollnitz、Derose和Salesin[62]中可以找到一个很好的、易于访问的小波及其在图像处理和计算机图形中的应用。Strang和Nguyen[66]中给出了一个非常详细的描述，但本书在信号处理方面有相当多的背景。

我们可以很容易地找到一个2n×2n=22n向量wij（2n×2n矩阵）的基，用于从其haar系数重建图像的线性映射，在任何2n×2n矩阵c的haar系数的意义上，图像矩阵a由下式给出：

2N 2N

A=XXCIJWIJ。

I=1 J=1

实际上，矩阵wij是由所谓的外积给出的。

wij=wi（wj）>。

同样，对于二维Haar变换，也有2n×2n=22n个向量hij（2n×2n矩阵）的基础，即对于任何2n×2n矩阵a，其Haar系数的矩阵c由下式给出：

2N 2N

C=XXaijhij.

I=1 J=1

如果w-1的列是，那么

.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image041.gif)

图4.13:1轮、2轮、3轮和9轮平均后的haar变换。

我们将它作为练习来计算n=2的基（wij）和（hij），并使用命令imagesc显示相应的图像。

## 4.6阿达玛矩阵

还有另一个著名的矩阵家族，类似于haar矩阵，但是这些矩阵有+1和−1条目（没有零条目）。

定义4.6.实n×n矩阵h是一个Hadamard矩阵，如果h i j=±1表示所有i，j，那么1≤i，j≤n，如果

h>h=nin。

因此，哈达玛矩阵的列是成对正交的。因为h是一个平方矩阵，所以方程h>h=nin表明h是可逆的，所以我们也有hh>=nin。


 

4.6。阿达玛矩阵

以下矩阵是Hadamard矩阵的示例：

和

.

一个自然的问题是确定正整数n，对于正整数n，维n的阿达玛矩阵存在，但令人惊讶的是，这是一个开放的问题。阿达玛猜想，对于n=4K形式的每一个正整数，都有一个维数为n的阿达玛矩阵。

已知的是一个必要条件和各种充分条件。

定理4.1。如果h是一个n×n的Hadamard矩阵，那么对于某个正整数k，n=1,2或n=4K。

Sylvester介绍了一个Hadamard矩阵家族，并用以下结构证明了所有m≥1都有尺寸为n=2m的Hadamard矩阵。

提案4.2.（西尔维斯特，1867）如果h是维n的阿达玛矩阵，那么维2n的块矩阵，

，

是阿达玛矩阵。

如果我们从

，

我们得到一个称为西尔维斯特-哈达玛矩阵的对称哈达玛矩阵的无穷大族，用h2m表示。西尔维斯特-哈达玛矩阵h2、h4和h8如前页所示。

1893年，Hadamard给出了n=12和n=20的Hadamard矩阵的例子。目前，已知Hadamard矩阵的所有n=4K≤1000，n=668716除外，以及

892。

Hadamard矩阵在纠错码、信号处理和数字线性代数方面有多种应用；见Seberry、Wysocki和Wysocki[56]和Tropp[69]。例如，有一个基于H32的代码，它可以纠正任何32位编码块中的7个错误，并且可以检测到第八个错误。1969年，这段代码被用在一艘水手号宇宙飞船上，用来把照片传回地球。

对于每m≥0，与Sylvester–Hadamard矩阵H2m的2 m行相关的分段仿射函数plf（（h2m）i）是[0,1]上的函数，称为沃尔什函数。通常用整数0,1，…，2M−1对这两个2M函数进行索引，这样沃尔什函数wal（k，t）等于与包含连续+1组和连续-1组之间符号k变化的H2M行i相关联的函数plf（（h2m）i）。例如，h8的第五行，即

−−−，

有五个连续的+1s和−1s块，这些块之间有四个符号变化，因此与wal（4，t）相关。尤其是，对应于h8行（自上而下）的walsh函数是：

沃尔玛（0，t），沃尔玛（7，t），沃尔玛（3，t），沃尔玛（4，t），沃尔玛（1，t），沃尔玛（6，t），沃尔玛（2，t），沃尔玛（5，t）。

由于西尔维斯特-哈达玛矩阵与沃尔什函数之间的联系，一些作者将西尔维斯特-哈达玛矩阵称为沃尔什-哈达玛矩阵。对于每m，2 m沃尔什函数是成对正交的。所有m≥0和所有k的沃尔什函数wal（k，t）的可数集，使得0≤k≤2m−1可以这样排序，即它是希尔伯特空间l2的正交希尔伯特基（[0,1]）；见Seberry、Wysocki和Wysocki[56]。

Sylvester-Hadamard矩阵h2m在各种降维和低阶矩阵逼近算法中发挥了作用。有一种称为次抽样随机Hadamard变换的结构化降维图，简称SRHT；见Trop[69]和Halko、Martinsson和Trop[33]。对于，srht矩阵是形式的`×n矩阵

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image043.gif)

哪里

\1.    d是一个随机n×n对角矩阵，其项是独立的随机符号。

\2.    h=n−1/2hn，尺寸n的归一化西尔维斯特-哈达玛矩阵。

\3.    r是一个随机的`×n矩阵，它将一个n维向量限制为`坐标，随机均匀选择。

在tropp[69]中解释，对于任何输入x，如kxk2=1，概率为

|（hdx）i≥pn−1对数（n），对于任何i来说都很小。因此，hd具有“展平”输入x的效果。有关srht的主要结果是，它保留了向量的整个子空间的几何；参见tropp[69]（定理1.3）。

4.7。总结

## 4.7总结

本章的主要概念和结果如下：

•     Haar基向量和Haar小波的一瞥。

•     矩阵的克罗内克积（或张量积）。

•     Hadamard和Sylvester–Hadamard矩阵。

•     沃尔什函数。

## 4.8问题

问题4.1。（哈尔瓦朗萨）考虑矩阵

| 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 0         网络错误   网络错误   网络错误   1         网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   0   网络错误   1   网络错误   网络错误 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
|                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |

(1)        证明在给定任何向量c=（c1，c2，c3，c4，c5，c6，c7，c8）的情况下，应用结果w3，3c

W3,3至C为

w3,3c=（c1+c5，c1−c5，c2+c6，c2−c6，c3+c7，c3−c7，c4+c8，c4−c8）

从haar系数重建向量的最后一步。

(2)        证明W3,3的倒数是（1。证明w3，3的列和行是正交的。

(3)        设w3,2和w3,1为下列矩阵：

| ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image045.gif)               0     0     1     1     0     0     0     0               1 −1     0     0     0     0     0     0               0     0 1 −1     0     0     0     0               0     0     0     0     1     0     0     0               0     0     0     0     0     1     0     0               0     0     0     0     0     0     1     0               0     0     0     0 0*,*     0     0 1 | ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image047.gif)               1 −1     0     0     0     0     0     0               0     0     1     0     0     0     0     0               0 0 0     1     0     0     0     0               0     0     0     0     1     0     0     0               0     0     0     0     0     1     0     0               0     0     0     0     0     0     1     0               0     0     0     0 0*.*     0     0 1 |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
|                                                              |                                                              |

证明在给定任何向量c=（c1，c2，c3，c4，c5，c6，c7，c8）的情况下，将w3,2应用于c的结果是

w3,2c=（c1+c3，c1−c3，c2+c4，c2−c4，c5，c6，c7，c8）

从haar系数重建向量的第二步以及将w3,1应用于c的结果w3,1c是

w3,1c=（c1+c2，c1−c2，c3，c4，c5，c6，c7，c8）

从haar系数重建向量的第一步。得出结论

| 网络错误 |                                                              | 网络错误                                                     |                                                              |                                                              |                                                              |                                                              |                                           |                                                              |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------------------------- | ------------------------------------------------------------ |
|          | ![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image049.gif) | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误 | 网络错误   网络错误   网络错误   网络错误   0   网络错误   1   网络错误   网络错误 |
| 网络错误 |                                                              |                                                              |                                                              |                                                              |                                                              |                                                              |                                           |                                                              |

，

哪里

.

（4）证明w3,2和w3,1的列和行是正交的。由此推断W3的列是正交的，W3-1的行是正交的。w3的行是正交的吗？W3-1的列是正交的吗？求w3,2的倒数和w3,1的倒数。

问题4.2。这是问题4.1的延续。

(1)        对于任何n≥2，从这两行得到2n×2n矩阵wn，n

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image051.gif)

通过每次在左侧插入一个零，将它们向右移动2n-1-1次。

4.8。问题

给出任意向量c=（c1，c2，…，c2 n），表明wn，nc是从其haar系数c重建向量的最后一步的结果。证明，并且wn，n的列和行是正交的。

(2)        给定m×n矩阵a=（aij）和p×q矩阵b=（bij），a和b的Kronecker积（或张量积）a b是mp×nq矩阵。

A11B A12B···A1NB

A21B A22B···A2NB

A B=…………。

γ

AM1B AM2B···AMNB

可以证明是关联的，并且

（a b）（c d）=ac bd

（a b）>=a>b>，

只要AC和BD定义良好。

检查那个

，

还有那个

用上面的话来反驳

让

对于n≥1，

证明这一点

，对于所有n≥1。

(3)        矩阵wn，i从矩阵wi，i（1≤i≤n-1）中获得，如下所示：

.

它由四个块组成，其中02i、2n-2i和02n-2i、2i是零的矩阵，i2n-2i是维度2n-2i的标识矩阵。

解释一下wn，我对c做了什么，并证明

wn，nwn，n−1···wn，1=wn，

其中，wn是维度2n的haar矩阵。

暗示。在k上使用归纳法，使用归纳假设

.

证明wn、k的列和行是正交的，并以此证明wn的列和wn-1的行是正交的。wn的行是正交的吗？wn-1的列是正交的吗？证明这一点

.

问题4.3。证明如果h是一个维数n的阿达玛矩阵，那么维数2n的分块矩阵，

，

是阿达玛矩阵。

问题4.4.绘制k=0,1，…，7的八个沃尔什函数wal（k，t）的图。

问题4.5。描述一种递归算法，通过使用m递归调用的向量x∈r2m计算西尔维斯特-哈达玛矩阵h2m的乘积h2m x。